{
	"RuoliAbilitati" : "",
	"EditSQL" : [
		{
			"Name" : "Inserisci",
			"SQL" : "INSERT INTO ddt_uscenti (CHIAVE, NUMERO_DDT, ID_CLIENTE, ID_FORNITORE, ANNO_DDT,STATO_DDT,\n                     RAGIONE_SOCIALE, INDIRIZZO_FATTURAZIONE, CODICE_FISCALE,  NR_CIVICO_FATTURAZIONE,\n                     COMUNE_FATTURAZIONE, PROVINCIA_FATTURAZIONE, CAP_FATTURAZIONE,\n                     DATA_DDT, TRASPORTO_A_MEZZO, CAUSALE, ASPETTO_BENI, NUMERO_COLLI,\n                     COMUNE_DESTINAZIONE, PROVINCIA_DESTINAZIONE, CAP_DESTINAZIONE, NR_CIVICO_DESTINAZIONE,\n                     INDIRIZZO_DESTINAZIONE, PORTO, ORA_INIZIO,\n                     DATA_INIZIO, NOTE, FILIALE, DESTINAZIONE,\n                     PARTITA_IVA, PESO, NAZIONE_DESTINAZIONE, NAZIONE_EM_PIVA,\n                     STATO_DESTINAZIONE, NON_FATTURARE, ID_MAGAZZINO)\n             VALUES (:NewKey1, NEW_NUMERO_DDT(EXTRACT(YEAR FROM #DATA_DDT)), :ID_CLIENTE, :ID_FORNITORE, EXTRACT(YEAR FROM #DATA_DDT),\n                     #STATO_DDT,#RAGIONE_SOCIALE, #INDIRIZZO_FATTURAZIONE, #CODICE_FISCALE, #NR_CIVICO_FATTURAZIONE,\n                     #COMUNE_FATTURAZIONE, :PROVINCIA_FATTURAZIONE, #CAP_FATTURAZIONE,\n                     #DATA_DDT, #TRASPORTO_A_MEZZO, :CAUSALE, #ASPETTO_BENI, :NUMERO_COLLI,\n                     #COMUNE_DESTINAZIONE, :PROVINCIA_DESTINAZIONE, #CAP_DESTINAZIONE, #NR_CIVICO_DESTINAZIONE,\n                     #INDIRIZZO_DESTINAZIONE, #PORTO, #ORA_INIZIO,\n                     #DATA_INIZIO, #NOTE, :FILIALE, #DESTINAZIONE,\n                     #PARTITA_IVA, #PESO, :NAZIONE_DESTINAZIONE, :NAZIONE_EM_PIVA,\n                     #STATO_DESTINAZIONE, #NON_FATTURARE, :ID_MAGAZZINO)\n"
		},
		{
			"Name" : "Modifica",
			"SQL" : "UPDATE ddt_uscenti SET\n                   NUMERO_DDT = :NUMERO_DDT,\n                   ID_CLIENTE = :ID_CLIENTE,\n                   ID_FORNITORE = :ID_FORNITORE,\n                   ANNO_DDT = EXTRACT(YEAR FROM #DATA_DDT),\n                   STATO_DDT = #STATO_DDT,\n                   RAGIONE_SOCIALE = #RAGIONE_SOCIALE,\n                   INDIRIZZO_FATTURAZIONE = #INDIRIZZO_FATTURAZIONE,\n                   COMUNE_FATTURAZIONE = #COMUNE_FATTURAZIONE,\n                   PROVINCIA_FATTURAZIONE = :PROVINCIA_FATTURAZIONE,\n                   CAP_FATTURAZIONE = #CAP_FATTURAZIONE,\n                   DATA_DDT = #DATA_DDT,\n                   TRASPORTO_A_MEZZO = #TRASPORTO_A_MEZZO,\n                   CAUSALE = :CAUSALE,\n                   ASPETTO_BENI = #ASPETTO_BENI,\n                   NUMERO_COLLI = :NUMERO_COLLI,\n                   PORTO = #PORTO,\n                   ORA_INIZIO = #ORA_INIZIO,\n                   DATA_INIZIO = #DATA_INIZIO,\n                   NOTE = #NOTE,\n                   INDIRIZZO_DESTINAZIONE = #INDIRIZZO_DESTINAZIONE,\n                   DESTINAZIONE = #DESTINAZIONE,\n                   COMUNE_DESTINAZIONE = #COMUNE_DESTINAZIONE,\n                   PROVINCIA_DESTINAZIONE = #PROVINCIA_DESTINAZIONE,\n                   CAP_DESTINAZIONE = #CAP_DESTINAZIONE,\n                   FILIALE = :FILIALE,\n                   PARTITA_IVA = #PARTITA_IVA,\n                   CODICE_FISCALE = #CODICE_FISCALE,\n                   PESO = #PESO,\n                   STATO_DESTINAZIONE = #STATO_DESTINAZIONE,\n                   NON_FATTURARE = #NON_FATTURARE,\n                   NR_CIVICO_DESTINAZIONE = #NR_CIVICO_DESTINAZIONE,\n                   NR_CIVICO_FATTURAZIONE = #NR_CIVICO_FATTURAZIONE,\n                   NAZIONE_DESTINAZIONE = :NAZIONE_DESTINAZIONE,\n                   NAZIONE_EM_PIVA = :NAZIONE_EM_PIVA,\n                   ID_MAGAZZINO = :ID_MAGAZZINO\n             WHERE CHIAVE = :CHIAVE\n"
		},
		{
			"Name" : "Elimina",
			"SQL" : "DELETE FROM ddt_uscenti WHERE CHIAVE = :CHIAVE_DDT\n"
		},
		{
			"Name" : "InserisciVoce",
			"SQL" : "INSERT INTO voci_ddt_uscenti (CHIAVE, ID_DDT, DESCRIZIONE, QUANTITA,\n                                              UNITA_DI_MISURA, ORDINAMENTO, IMPORTO, IVA, SCONTO, ID_PRODOTTO)\n                  VALUES (:NewKey2, :NewKey1!ID_DDT, #DESCRIZIONE, :QUANTITA,\n                               :UNITA_DI_MISURA, #ORDINAMENTO, :IMPORTO, :IVA, :SCONTO, :ID_PRODOTTO)\n"
		},
		{
			"Name" : "ModificaVoce",
			"SQL" : "UPDATE voci_ddt_uscenti\n      SET DESCRIZIONE = #DESCRIZIONE,\n             QUANTITA = :QUANTITA,\n             ORDINAMENTO = :ORDINAMENTO,\n             UNITA_DI_MISURA = :UNITA_DI_MISURA,\n             IMPORTO = :IMPORTO,\n             IVA = :IVA,\n             SCONTO = :SCONTO\n WHERE CHIAVE = :CHIAVE\n"
		},
		{
			"Name" : "EliminaVoce",
			"SQL" : "DELETE FROM voci_ddt_uscenti\n WHERE CHIAVE = :CHIAVE\n"
		},
		{
			"Name" : "InserisciAllegato",
			"SQL" : "INSERT INTO allegati_ddt_uscenti (CHIAVE, ALLEGATO, ID_DDT, DESCRIZIONE)\n                      VALUES (:NewKey2, $ALLEGATO, :NewKey1!ID_DDT, #DESCRIZIONE)\n"
		},
		{
			"Name" : "ModificaAllegato",
			"SQL" : "UPDATE allegati_ddt_uscenti\n   SET CHIAVE = :CHIAVE,\n       DESCRIZIONE = #DESCRIZIONE,\n       ALLEGATO = $ALLEGATO\n WHERE CHIAVE = :CHIAVE\n"
		},
		{
			"Name" : "EliminaAllegato",
			"SQL" : "DELETE from allegati_ddt_uscenti\n WHERE CHIAVE = :CHIAVE\n"
		},
		{
			"Name" : "EliminaAllegatoTramiteDDT",
			"SQL" : "DELETE FROM allegati_ddt_uscenti\n WHERE ID_DDT = :CHIAVE_DDT\n"
		},
		{
			"Name" : "EliminaVoceTramiteDDT",
			"SQL" : "DELETE FROM voci_ddt_uscenti\n WHERE ID_DDT = :CHIAVE_DDT\n"
		},
		{
			"Name" : "InserisciCollegamentoFattura",
			"SQL" : "UPDATE ddt_uscenti\n     SET ID_FATTURA = :CHIAVE_FATTURA\n WHERE CHIAVE = :CHIAVE_DDT\n"
		},
		{
			"Name" : "CollegaDDTAlPreventivo",
			"SQL" : "UPDATE preventivi\n      SET ID_DDT_USCENTI = :NewKey1\n WHERE CHIAVE = :CHIAVE_PREVENTIVO\n"
		},
		{
			"Name" : "EliminaCorrelazionePreventivo",
			"SQL" : "UPDATE preventivi\n      SET ID_DDT_USCENTI = NULL\n WHERE ID_DDT_USCENTI = :CHIAVE_DDT\n"
		},
		{
			"Name" : "InserisciLog",
			"SQL" : "INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, QUANTITA, DESCRIZIONE)\n                            VALUES (:NewKey2, #DATA, :ID_PRODOTTO, :QUANTITA,  'Aggiunta voce DDT')\n"
		}
	],
	"FiltroDDT" : [
		{
			"Name" : "FiltroDDT",
			"SQL" : "SELECT CHIAVE,\n            NUMERO_DDT, \n            ANNO_DDT, \n            ID_CLIENTE,\n            ID_FORNITORE, \n            STATO_DDT,\n            RAGIONE_SOCIALE,\n            ID_FATTURA\n  FROM ddt_uscenti\n  {W~NumeroDDT~NUMERO_DDT = :NumeroDDT\n      ~AnnoDDT~ANNO_DDT = :AnnoDDT\n      ~DalNr~NUMERO_DDT >= :DalNr\n      ~AlNr~NUMERO_DDT <= :AlNr\n      ~Anno1~ANNO_DDT >= :Anno1\n      ~Anno2~ANNO_DDT <= :Anno2\n      ~DallaData~DATA_DDT >= #DallaData\n      ~AllaData~DATA_DDT <= #AllaData\n      ~StatoDDT~ STATO_DDT = #StatoDDT\n      ~Intestatario~ UPPER(RAGIONE_SOCIALE) LIKE UPPER(#Intestatario)\n      ~PartitaIva~ UPPER(PARTITA_IVA) LIKE UPPER(#PartitaIva)\n      ~Cliente~ ID_CLIENTE = :Cliente}\n{O~OrdinaXData~ANNO_DDT DESC\n    ~OrdinaXNumero~ANNO_DDT DESC, NUMERO_DDT DESC}\nLIMIT :LimitNumRows OFFSET :LimitStart\n"
		}
	],
	"ListaDDTVoci" : [
		{
			"Name" : "ListaDDTVoci",
			"SQL" : "SELECT ddt_uscenti.CHIAVE, \n            ddt_uscenti.DATA_DDT, \n            ddt_uscenti.NUMERO_DDT, \n            ddt_uscenti.RAGIONE_SOCIALE,\n            clienti.RAGIONE_SOCIALE AS RAGIONE_SOCIALE_CLIENTE, \n            clienti.CODICE_CLIENTE\n  FROM ddt_uscenti\n            LEFT OUTER JOIN clienti ON clienti.CHIAVE = ddt_uscenti.ID_CLIENTE\n WHERE ddt_uscenti.ID_CLIENTE = :CHIAVE\n     AND ddt_uscenti.ID_FATTURA IS NULL\n {w~DallaData~DATA_DDT >= #DallaData\n     ~AllaData~DATA_DDT <= #AllaData}\n  ORDER BY ddt_uscenti.DATA_DDT DESC\n"
		}
	],
	"ListaVociDDTSelezionati" : [
		{
			"Name" : "ListaVociDDTSelezionati",
			"SQL" : "SELECT voci_ddt_uscenti.*, \n            ddt_uscenti.DESTINAZIONE, \n            ddt_uscenti.NUMERO_DDT, \n            ddt_uscenti.DATA_DDT,\n            ddt_uscenti.CHIAVE AS CHIAVE_DDT,\n            ddt_uscenti.INDIRIZZO_DESTINAZIONE,\n            ddt_uscenti.COMUNE_DESTINAZIONE,\n            ddt_uscenti.NR_CIVICO_DESTINAZIONE\n  FROM voci_ddt_uscenti\n   LEFT OUTER JOIN ddt_uscenti ON ddt_uscenti.CHIAVE = voci_ddt_uscenti.ID_DDT\nWHERE voci_ddt_uscenti.ID_DDT IN ?ListaCheckati\nORDER BY ID_DDT, ORDINAMENTO\n"
		}
	],
	"LsAnnoDDTXCliente" : [
		{
			"Name" : "LsAnnoDDT",
			"SQL" : "SELECT ddt_uscenti.ANNO_DDT\n  FROM ddt_uscenti\n  WHERE ddt_uscenti.ID_CLIENTE = :ChiaveCliente\n    AND ddt_uscenti.ID_FORNITORE IS NULL\nGROUP BY ddt_uscenti.ANNO_DDT \nORDER BY ANNO_DDT DESC\n"
		}
	],
	"LsAnnoDDTXFornitore" : [
		{
			"Name" : "LsAnnoDDT",
			"SQL" : "SELECT EXTRACT(YEAR FROM DATA_DDT) AS ANNO_DDT\n  FROM ddt_uscenti\n  WHERE ID_FORNITORE = :ChiaveFornitore\n    AND ID_CLIENTE IS NULL\nGROUP BY EXTRACT(YEAR FROM DATA_DDT) \nORDER BY EXTRACT(YEAR FROM DATA_DDT) DESC\n"
		}
	],
	"RiassuntoDDTPerAnno" : [
		{
			"Name" : "RiassuntoPerCliente",
			"SQL" : "SELECT CHIAVE,\n            NUMERO_DDT, \n            ANNO_DDT, \n            ID_CLIENTE,\n            ID_FORNITORE, \n            STATO_DDT,\n            RAGIONE_SOCIALE,\n            ID_FATTURA\n  FROM ddt_uscenti\n  WHERE ID_CLIENTE = :ChiaveCliente\n      AND ANNO_DDT = :AnnoDDT\n      AND ID_CLIENTE IS NOT NULL\n      AND ID_FORNITORE IS NULL\nORDER BY ANNO_DDT DESC\n"
		}
	],
	"RiassuntoDDTPerAnnoFornitore" : [
		{
			"Name" : "RiassuntoPerFornitore",
			"SQL" : "SELECT CHIAVE,\n       NUMERO_DDT, \n       ANNO_DDT, \n       ID_CLIENTE,\n       ID_FORNITORE, \n       STATO_DDT,\n       RAGIONE_SOCIALE,\n       ID_FATTURA\n  FROM ddt_uscenti\n  WHERE ID_FORNITORE = :ChiaveFornitore\n    AND ANNO_DDT = :AnnoDDT\n    AND ID_CLIENTE IS NULL\n    AND ID_FORNITORE IS NOT NULL\n"
		}
	],
	"SelectDettaglio" : [
		{
			"Name" : "Dettaglio",
			"SQL" : "SELECT ddt_uscenti.*,\n            fatture.NUMERO AS NUMERO_FATTURA,\n            fatture.CHIAVE AS CHIAVE_FATTURA\n  FROM ddt_uscenti\n            LEFT OUTER JOIN fatture ON fatture.CHIAVE = ddt_uscenti.ID_FATTURA\n WHERE ddt_uscenti.CHIAVE = :CHIAVE\n"
		},
		{
			"Name" : "AllegatiDDT",
			"SQL" : "SELECT CHIAVE, DESCRIZIONE, ID_DDT, ALLEGATO\n  FROM allegati_ddt_uscenti\n WHERE ID_DDT = :ChiaveDDT\n"
		},
		{
			"Name" : "VociDDT",
			"SQL" : "SELECT *\n  FROM voci_ddt_uscenti\n WHERE ID_DDT = :ChiaveDDT\n"
		},
		{
			"Name" : "LogDDT",
			"SQL" : "SELECT log_magazzino.DATA, log_magazzino.ID_PRODOTTO, log_magazzino.DESCRIZIONE, log_magazzino.CHIAVE\n  FROM log_magazzino\n WHERE ID_PRODOTTO = :CHIAVE\n ORDER BY log_magazzino.DATA DESC\n"
		}
	],
	"SelectSQL" : [
		{
			"Name" : "LsDDT",
			"SQL" : "SELECT *\n  FROM ddt_uscenti\n WHERE ID_CLIENTE = :ChiaveCliente\n"
		}
]
}
