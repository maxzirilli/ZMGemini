##VERSIONE: 0,0,0
##STORIA
Inserire qui la storia del database
##END_STORIA
##TABELLA
access_permission
##CAMPI_TABELLA
IP_ADDRESS	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
WHITE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
IP_ADDRESS	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
advquery_access
##CAMPI_TABELLA
DATA	__FALSE__	timestamp	__FALSE__	__CAMPO_VUOTO__	CURRENT_TIMESTAMP	__NULL__	
IP_ADDRESS	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SUCCESS	__FALSE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
USERNAME	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
DATA	IP_ADDRESS	USERNAME	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
advquery_log_edit_dbase
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__FALSE__	timestamp	__FALSE__	__CAMPO_VUOTO__	CURRENT_TIMESTAMP	__NULL__	
ID_UTENTE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
MODELLO	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUERY_NAME	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARAMETRI	__FALSE__	mediumtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUERY_BODY	__FALSE__	mediumtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ADVQUERY_UTENTI	ID_UTENTE	utenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_autofatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_AUTOFATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ALLEGATI_AUTOFATT_ID_AUTOFATT	ID_AUTOFATTURA	autofatture	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_clienti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ALLEGATI_CLIENTI_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_ddt_entranti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_DDT	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ALLEGATO_ID_DDT	ID_DDT	ddt_entranti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_ddt_uscenti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_DDT	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ALLEGATO_ID_DDT	ID_DDT	ddt_uscenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_doc_scarico_prod_composti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_DOCUMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_DOCUMENTO_ALLEGATI	ID_DOCUMENTO	doc_scarico_prodotti_composti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_fatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_FATTURA	ID_FATTURA	fatture	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_fatture_passive
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_PASSIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ALLEGATI_FATTURE_PASSIVE	ID_FATTURA_PASSIVA	fatture_passive	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_log_email
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_LOG_EMAIL	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ALEGATI_LOG_EMAIL_ID_LOG_EMAIL	ID_LOG_EMAIL	log_email	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_messaggio
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MESSAGGIO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOME_FILE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TIPO	__TRUE__	enum('A','P','I')	__FALSE__	__CAMPO_VUOTO__	A	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ALLEGATI_MESSAGGIO_ID_MESSAGGIO	ID_MESSAGGIO	messaggi	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_note_di_credito
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_NOTA_DI_CREDITO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ID_NOTA_DI_CREDITO	ID_NOTA_DI_CREDITO	note_di_credito	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_preventivi
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PREVENTIVO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_PREVENTIVO	ID_PREVENTIVO	preventivi	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
allegati_preventivi_multiparametrici
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PREVENTIVO_MULTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ALLEGATI_MULTI_ID_PREVENTIVO_MULTI	ID_PREVENTIVO_MULTI	preventivi_multiparametrici	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
amministratori
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COD_ENTE_SDI	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PEC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COD_UFFICIO_DEST	__TRUE__	varchar(6)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ZONA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DALLE_ORE	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLE_ORE	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DALLE_ORE2	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLE_ORE2	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DALLE_ORE3	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLE_ORE3	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DALLE_ORE4	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLE_ORE4	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
GIORNO_APERTURA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
GIORNO_APERTURA2	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
NOTE_NASCOSTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
AVVISO_AMMINISTRATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ID_TITOLO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TIPO_FATTURAZIONE	__TRUE__	enum('A','S')	__FALSE__	__CAMPO_VUOTO__	A	__NULL__	
GIORNO_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
MESE_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_AMMINISTRATORI_ID_TITOLO	ID_TITOLO	titoli	CHIAVE	
FK_AMMINISTRATORI_NAZIONE_FATTURAZIONE	NAZIONE_FATTURAZIONE	nazioni	CHIAVE	
FK_AMMINISTRATORI_PROVINCIA_FATTURAZIONE	PROVINCIA_FATTURAZIONE	province	CHIAVE	
FK_AMMINISTRATORI_ZONA_FATTURAZIONE	ZONA_FATTURAZIONE	zone	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
amministratori_telefono
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
TELEFONO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
EMAIL	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ID_AMMINISTRATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PRINCIPALE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PER_RAPPORTI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_AMMINISTRATORI_TELEFONO_ID_AMM	ID_AMMINISTRATORE	amministratori	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
autofatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_DEL_FORNITORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MESE_GENERAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
NAZIONE_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ESIGIBILITA_IVA	__TRUE__	enum('D','I','S')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAUSALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COD_ENTE_SDI	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
ENTE_PUBBLICO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PEC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
INVIATA_ALLO_SDI	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
TIPO_AUTOFATTURA	__TRUE__	enum('I','E','S','A','F','P')	__FALSE__	__CAMPO_VUOTO__	E	__NULL__	
REGIME_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	RF01	__NULL__	
TIPO_RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	2	__NULL__	
STATO_ESPORTAZIONE_MANUALE	__TRUE__	enum('C','D','I','Z')	__FALSE__	__CAMPO_VUOTO__	C	__NULL__	
DATA_ESPORTAZIONE_MANUALE_INVIATO	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_AUTOFATTURE_CAUSALE	CAUSALE	causali	CHIAVE	
FK_AUTOFATTURE_ID_FORNITORE	ID_FORNITORE	fornitori	CHIAVE	
FK_AUTOFATTURE_PROVINCIA_FATT	PROVINCIA_FATTURAZIONE	province	CHIAVE	
##END_FOREIGN_KEY
##UNIQUE_KEY
##CAMPI_UNIQUE_KEY
NUMERO	ANNO	
##END_CAMPI_UNIQUE_KEY
UNQ_AUTOFATTURE	
##END_UNIQUE_KEY
##END_TABELLA 
##TABELLA
casse_previdenziali_fatt_pass
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_PASSIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TIPO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALIQUOTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPOSTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_CASSA__PREVIDENZIALE_FATT_PASS	ID_FATTURA_PASSIVA	fatture_passive	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
cat_clienti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
cat_movimenti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
causali
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RIFERIMENTO	__TRUE__	enum('C','F')	__FALSE__	__CAMPO_VUOTO__	C	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
cfg_fattura_elettronica
##CAMPI_TABELLA
PAESE_TRASMITTENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PIVA_TRASMITTENTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
NAZIONE_EM_PIVA_PRESTATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DENOMINAZIONE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
COGNOME_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
REGIME_FISCALE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	RF01	__NULL__	
INDIRIZZO_SEDE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
NR_CIVICO_SEDE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CAP_SEDE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
COMUNE_SEDE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
NAZIONE_SEDE_PRESTATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_SUCCURSALE_PRESTATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_SUCCURSALE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
COMUNE_SUCCURSALE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
NR_CIVICO_SUCCURSALE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CAP_SUCCURSALE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
PRESTATORE_PERSONA_FISICA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	T	__NULL__	
ISCRITTO_REA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
NUMERO_REA	__TRUE__	varchar(20)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CAPITALE_SOCIALE_REA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SOCIO_UNICO_REA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
IN_LIQUIDAZIONE_REA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
RAPPRESENTANTE_FISCALE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PARTITA_IVA_RAPPR_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
NAZIONE_EM_PIVA_RAPPR_FISCALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DENOMINAZIONE_RAPPR_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
COGNOME_RAPPR_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
RAPPR_FISCALE_PERSONA_FISICA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	T	__NULL__	
PROVINCIA_SEDE_PRESTATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_SUCCURSALE_PRESTATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TELEFONO_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
EMAIL_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
TIPO_RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAUSALE_RITENUTA	__TRUE__	char(10)	__FALSE__	__CAMPO_VUOTO__	A	__NULL__	
ID_PROVINCIA_REA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_SDI_PRESTATORE	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
PEC_PRESTATORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##FOREIGN_KEY
FK_FATT_ELETTR_NAZIONE_EM_PIVA	NAZIONE_EM_PIVA_PRESTATORE	nazioni	CHIAVE	
FK_FATT_ELETTR_NAZIONE_EM_PIVA_RAPPR	NAZIONE_EM_PIVA_RAPPR_FISCALE	nazioni	CHIAVE	
FK_FATT_ELETTR_NAZIONE_SEDE_PREST	NAZIONE_SEDE_PRESTATORE	nazioni	CHIAVE	
FK_FATT_ELETTR_NAZIONE_SUCC_PREST	NAZIONE_SUCCURSALE_PRESTATORE	nazioni	CHIAVE	
FK_FATT_ELETTR_PAESE_TRASMITTENTE	PAESE_TRASMITTENTE	nazioni	CHIAVE	
FK_FATT_ELETTR_PROV_SEDE_PREST	PROVINCIA_SEDE_PRESTATORE	province	CHIAVE	
FK_FATT_ELETTR_PROV_SUCC_PREST	PROVINCIA_SUCCURSALE_PRESTATORE	province	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
clienti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_CLIENTE	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ID_AMMINISTRATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ENTE_PUBBLICO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPIANTO_REVERSE_CHARGE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
COD_ENTE_SDI	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ZONA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PRESSO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_SPEDIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_SPEDIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_SPEDIZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_SPEDIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_SPEDIZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ZONA_SPEDIZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_SPEDIZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ESIGIBILITA_IVA	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NATURA_PAGAMENTO	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COND_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE_IN_FATTURA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTO_CORRENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BANCA_APPOGGIO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IBAN	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BIC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
SWIFT	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
EMAIL	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PEC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
FAX	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ATTIVO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	T	__NULL__	
BOLLO	__TRUE__	enum('N','P','C')	__FALSE__	__CAMPO_VUOTO__	N	__NULL__	
SPESE_INCASSO_DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	Spese per incasso	__NULL__	
SPESE_INCASSO_SUGGERITE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
COD_UFFICIO_DEST	__TRUE__	varchar(6)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
IVA_SUGGERITA_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
CONDOMINIO_CON_FATTURAZIONE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
IS_A_CONDOMINIO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
SOGLIA_PRESENTE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
SOGLIA_X_NO_IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
SOGLIA_NAT_PAG	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PASSATA_AD_AVVOCATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ATTREZZATURE_INTERCAMBIABILI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
SCONTO_GENERALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PRIORITA_INVERSA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_CAT_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITIRO_CON_SOSTITUZIONE_EST	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_CLIENTI_COND_PAGAMENT	COND_PAGAMENTO	cond_pagamento	CHIAVE	
FK_CLIENTI_CONTO_CORRENTE	ID_CONTO_CORRENTE	conti_correnti_casse	CHIAVE	
FK_CLIENTI_ID_AMMINISTRATORE	ID_AMMINISTRATORE	amministratori	CHIAVE	
FK_CLIENTI_ID_CAT_CLIENTE	ID_CAT_CLIENTE	cat_clienti	CHIAVE	
FK_CLIENTI_NAZ_EM_PIVA	NAZIONE_EM_PIVA	nazioni	CHIAVE	
FK_CLIENTI_NAZ_SPEDIZIONE	NAZIONE_SPEDIZIONE	nazioni	CHIAVE	
FK_CLIENTI_PROV_FATTURAZIONE	PROVINCIA_FATTURAZIONE	province	CHIAVE	
FK_CLIENTI_PROV_SPEDIZIONE	PROVINCIA_SPEDIZIONE	province	CHIAVE	
FK_CLIENTI_ZONA_FATTURAZIONE	ZONA_FATTURAZIONE	zone	CHIAVE	
FK_CLIENTI_ZONA_SPEDIZ	ZONA_SPEDIZIONE	zone	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
clienti_agenda
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EVENTO	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_AGENDA_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
clienti_email_segnalazioni
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EMAIL	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
clienti_listino_sconti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TIPO_SCONTO	__FALSE__	enum('S','P')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
VALORE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_CLIENTE_SCONTO	ID_CLIENTE	clienti	CHIAVE	
FK_PRODOTTO_SCONTO	ID_PRODOTTO	prodotti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
clienti_telefono
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TELEFONO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PRINCIPALE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EMAIL	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_TELEFONO_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
codici_fornitore
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_PRODOTTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_CODICE_ID_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
FK2_CODICE_ID_FORNITORE	ID_FORNITORE	fornitori	CHIAVE	
##END_FOREIGN_KEY
##UNIQUE_KEY
##CAMPI_UNIQUE_KEY
CODICE_PRODOTTO	ID_FORNITORE	
##END_CAMPI_UNIQUE_KEY
CODICE_PRODOTTO	
##END_UNIQUE_KEY
##END_TABELLA 
##TABELLA
cond_pagamento
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RICEVUTA_BANCARIA	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
P30GG	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
P60GG	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
P90GG	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
P120GG	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
FINE_MESE	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COND_PAG_FATT_ELE	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MOD_PAG_FATT_ELE	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PAGAMENTO_OBBLIGATORIO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
FORZA_INVIO_FATTURE_SU_TABLET	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
conti_correnti_casse
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BANCA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
AGENZIA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CONTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BIC	__TRUE__	varchar(50)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SWIFT	__TRUE__	varchar(12)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
IBAN	__TRUE__	varchar(27)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_INIZIO_SESSIONE	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SALDO_AD_INIZIO_SESSIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CONTO_CORRENTE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE_ABBR	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
ddt_entranti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_DDT	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO_DDT	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_DDT	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TRASPORTO_A_MEZZO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAUSALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ASPETTO_BENI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_COLLI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PORTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORA_INIZIO	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_INIZIO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_DESTINAZIONE	__TRUE__	varchar(6)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
FILIALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
PESO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO_DESTINAZIONE	__TRUE__	char(2)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NON_FATTURARE	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO_DDT	__FALSE__	enum('C','A','I')	__FALSE__	__CAMPO_VUOTO__	I	__NULL__	
ID_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_DOCUMENTO_ENTRANTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_DOCUMENTO_ENTRANTE	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
FK_DDT_ENTRANTE_MAGAZZINO	ID_MAGAZZINO	magazzini	CHIAVE	
FK_FILIALE	FILIALE	filiali_clienti	CHIAVE	
FK_FORNITORE	ID_FORNITORE	fornitori	CHIAVE	
FK_ID_FATTURA	ID_FATTURA	fatture	CHIAVE	
FK_NAZIONE_DESTINAZIONE	NAZIONE_DESTINAZIONE	nazioni	CHIAVE	
FK_NAZIONE_EM_PIVA	NAZIONE_EM_PIVA	nazioni	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
ddt_entranti_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
  DECLARE OLD_ANNULLATO CHAR(1);
  DECLARE NEW_ANNULLATO CHAR(1);
  DECLARE ID_PRODOTTO INT;
  DECLARE QUANTITA_PRODOTTO INT;
  DECLARE ID_MAGAZZINO INT;
  DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
  DECLARE FINITO INT DEFAULT FALSE;
  
    DECLARE CursorVoci CURSOR FOR
        SELECT voci_ddt_entranti.ID_PRODOTTO,
               voci_ddt_entranti.QUANTITA,
               ddt_entranti.ID_MAGAZZINO
          FROM voci_ddt_entranti
               JOIN ddt_entranti ON voci_ddt_entranti.ID_DDT = ddt_entranti.CHIAVE
         WHERE voci_ddt_entranti.ID_DDT = OLD.CHIAVE;

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINITO = TRUE;

    IF OLD.ID_MAGAZZINO <> NEW.ID_MAGAZZINO THEN
        OPEN CursorVoci;
        LoopCursor: LOOP
            FETCH CursorVoci INTO ID_PRODOTTO, QUANTITA_PRODOTTO, ID_MAGAZZINO;
            IF FINITO THEN
                LEAVE LoopCursor;
            END IF;

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, OLD.ID_MAGAZZINO, QUANTITA_PRODOTTO);
            
            SELECT DESCRIZIONE 
				  INTO DESCRIZIONE_MAGAZZINO 
				  FROM magazzini 
				 WHERE CHIAVE = OLD.ID_MAGAZZINO;
				 
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, OLD.ID_MAGAZZINO, QUANTITA_PRODOTTO,
                    CONCAT('Ripristino quantità vecchio magazzino ', DESCRIZIONE_MAGAZZINO));

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, NEW.ID_MAGAZZINO, -QUANTITA_PRODOTTO);
            
				SELECT DESCRIZIONE 
				  INTO DESCRIZIONE_MAGAZZINO 
				  FROM magazzini 
				 WHERE CHIAVE = NEW.ID_MAGAZZINO;
				 
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, NEW.ID_MAGAZZINO, -QUANTITA_PRODOTTO,
                    CONCAT('Spostamento quantità nuovo magazzino ', DESCRIZIONE_MAGAZZINO));
        END LOOP;
        CLOSE CursorVoci;
    END IF; 
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
ddt_uscenti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_DDT	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO_DDT	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_DDT	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TRASPORTO_A_MEZZO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAUSALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ASPETTO_BENI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_COLLI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PORTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORA_INIZIO	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_INIZIO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_DESTINAZIONE	__TRUE__	varchar(6)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
FILIALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
PESO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO_DESTINAZIONE	__TRUE__	char(2)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NON_FATTURARE	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO_DDT	__FALSE__	enum('C','A','I')	__FALSE__	__CAMPO_VUOTO__	I	__NULL__	
ID_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_DDT_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
FK3_DDT_FILIALI	FILIALE	filiali_clienti	CHIAVE	
FK4_DDT_ID_FORNITORE	ID_FORNITORE	fornitori	CHIAVE	
FK_DDT_ID_FATTURA	ID_FATTURA	fatture	CHIAVE	
FK_DDT_MAGAZZINO	ID_MAGAZZINO	magazzini	CHIAVE	
FK_DDT_NAZIONE_DEST	NAZIONE_DESTINAZIONE	nazioni	CHIAVE	
FK_DDT_NAZIONE_EM_PIVA	NAZIONE_EM_PIVA	nazioni	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
ddt_uscenti_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
  DECLARE OLD_ANNULLATO CHAR(1) DEFAULT OLD.STATO_DDT = 'A';
  DECLARE NEW_ANNULLATO CHAR(1) DEFAULT NEW.STATO_DDT = 'A';
  DECLARE ID_PRODOTTO INT;
  DECLARE QUANTITA_PRODOTTO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
  DECLARE FINITO INT DEFAULT FALSE;
  
    DECLARE CursorVoci CURSOR FOR
        SELECT voci_ddt_uscenti.ID_PRODOTTO,
               voci_ddt_uscenti.QUANTITA,
               ddt_uscenti.ID_MAGAZZINO
                        FROM voci_ddt_uscenti
          JOIN ddt_uscenti ON voci_ddt_uscenti.ID_DDT = ddt_uscenti.CHIAVE
                      WHERE voci_ddt_uscenti.ID_DDT = OLD.CHIAVE;

  DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINITO = TRUE;

    IF OLD.ID_MAGAZZINO <> NEW.ID_MAGAZZINO THEN
        OPEN CursorVoci;
        LoopCursor: LOOP
            FETCH CursorVoci INTO ID_PRODOTTO, QUANTITA_PRODOTTO, ID_MAGAZZINO;
            IF FINITO THEN
                LEAVE LoopCursor;
            END IF;

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, OLD.ID_MAGAZZINO, QUANTITA_PRODOTTO);
            
            SELECT DESCRIZIONE 
				  INTO DESCRIZIONE_MAGAZZINO 
				  FROM magazzini 
				 WHERE CHIAVE = OLD.ID_MAGAZZINO;
				 
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, OLD.ID_MAGAZZINO, QUANTITA_PRODOTTO,
                    CONCAT('Ripristino quantità vecchio magazzino - ', DESCRIZIONE_MAGAZZINO));

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, NEW.ID_MAGAZZINO, -QUANTITA_PRODOTTO);
            
				SELECT DESCRIZIONE 
				  INTO DESCRIZIONE_MAGAZZINO 
				  FROM magazzini 
				 WHERE CHIAVE = NEW.ID_MAGAZZINO;
				 
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, NEW.ID_MAGAZZINO, -QUANTITA_PRODOTTO,
                    CONCAT('Spostamento quantità nuovo magazzino - ', DESCRIZIONE_MAGAZZINO));
        END LOOP;
        CLOSE CursorVoci;
    END IF;
  
  IF OLD_ANNULLATO AND NOT NEW_ANNULLATO THEN
    OPEN CursorVoci;
    LoopCursor: LOOP
	        FETCH CursorVoci INTO ID_PRODOTTO, QUANTITA_PRODOTTO, ID_MAGAZZINO;
      IF FINITO THEN
         LEAVE LoopCursor;
      END IF;
                
	        SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
	          FROM magazzini
	         WHERE CHIAVE = ID_MAGAZZINO;
        
	        INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
	        VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, ID_MAGAZZINO, -QUANTITA_PRODOTTO,
	                CONCAT('Ripristino quantità prodotto - Magazzino ', DESCRIZIONE_MAGAZZINO));
        
	        CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, ID_MAGAZZINO, -QUANTITA_PRODOTTO);
	    END LOOP;
      CLOSE CursorVoci;
  END IF;
  
  IF NOT OLD_ANNULLATO AND NEW_ANNULLATO THEN
    OPEN CursorVoci;
    LoopCursor: LOOP
            FETCH CursorVoci INTO ID_PRODOTTO, QUANTITA_PRODOTTO, ID_MAGAZZINO;
      IF FINITO THEN
         LEAVE LoopCursor;
      END IF;

            SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
              FROM magazzini
             WHERE CHIAVE = ID_MAGAZZINO;

            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, ID_MAGAZZINO, QUANTITA_PRODOTTO,
                    CONCAT('Rimozione quantita prodotto - Magazzino ', DESCRIZIONE_MAGAZZINO));
                  
            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, ID_MAGAZZINO, QUANTITA_PRODOTTO);
        END LOOP;
      CLOSE CursorVoci;
  END IF;
  
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
delta
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
TOKEN	__TRUE__	blob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
doc_scarico_prodotti_composti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_DOCUMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO_DOCUMENTO	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_DOCUMENTO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_DOC_SCARICO_MAGAZZINO	ID_MAGAZZINO	magazzini	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
email_programmate
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EMAIL_DEST	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
OGGETTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CORPO	__TRUE__	longtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EMAIL_INVIATA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
fatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTRATTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MESE_GENERAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
NAZIONE_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_DESTINAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COND_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COSTO_BOLLO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
PAGAMENTO_BOLLO	__TRUE__	enum('N','P','C')	__FALSE__	__CAMPO_VUOTO__	N	__NULL__	
NOTE_IN_FATTURA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ESIGIBILITA_IVA	__TRUE__	enum('D','I','S')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IBAN	__TRUE__	varchar(27)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BANCA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BIC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
SWIFT	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ID_CONTO_CORRENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAUSALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COD_ENTE_SDI	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
ENTE_PUBBLICO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PEC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
COD_UFFICIO_DEST	__TRUE__	varchar(6)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CIG	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CUP	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CONVENZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DATA_DOCUMENTO	__TRUE__	varchar(50)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DOCUMENTO_NR	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
VOCE_DI_RIFERIMENTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DOCUMENTO_CORRELATO	__TRUE__	enum('N','O','C')	__FALSE__	__CAMPO_VUOTO__	N	__NULL__	
INVIATA_ALLO_SDI	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
DA_BANCO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
REVERSE_CHARGE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_FILIALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_RAPPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANTICIPO	__TRUE__	enum('F','T')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
INVIATA_TRAMITE_EMAIL	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PASSATA_AD_AVVOCATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ACCOMPAGNATORIA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
DATA_RITENUTA_CERT	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_ANTICIPO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
ID_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTA_DI_DEBITO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
STATO_ESPORTAZIONE_MANUALE	__TRUE__	enum('C','D','I','Z')	__FALSE__	__CAMPO_VUOTO__	C	__NULL__	
DATA_ESPORTAZIONE_MANUALE_INVIATO	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_FATTURE_CAUSALI	CAUSALE	causali	CHIAVE	
FK_FATTURE_COND_PAGAMENTO	COND_PAGAMENTO	cond_pagamento	CHIAVE	
FK_FATTURE_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
FK_FATTURE_ID_CONTO_CORRENTE	ID_CONTO_CORRENTE	conti_correnti_casse	CHIAVE	
FK_FATTURE_ID_FILIALE	ID_FILIALE	filiali_clienti	CHIAVE	
FK_FATTURE_MAGAZZINO	ID_MAGAZZINO	magazzini	CHIAVE	
FK_FATTURE_NAZIONE_DEST	NAZIONE_DESTINAZIONE	nazioni	CHIAVE	
FK_FATTURE_NAZIONE_EM_PIVA	NAZIONE_EM_PIVA	nazioni	CHIAVE	
FK_FATTURE_PROVINCIA_DEST	PROVINCIA_DESTINAZIONE	province	CHIAVE	
FK_FATTURE_PROVINCIA_FATT	PROVINCIA_FATTURAZIONE	province	CHIAVE	
##END_FOREIGN_KEY
##UNIQUE_KEY
##CAMPI_UNIQUE_KEY
NUMERO	ANNO	DA_BANCO	NOTA_DI_DEBITO	
##END_CAMPI_UNIQUE_KEY
UNQ_FATTURE	
##END_UNIQUE_KEY
##TRIGGERS
fatture_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
  DECLARE ID_PRODOTTO INT;
  DECLARE QUANTITA_PRODOTTO INT;
  DECLARE FINITO INT DEFAULT FALSE;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
    DECLARE DESCRIZIONE_NUOVO_MAGAZZINO VARCHAR(255);
    DECLARE NUMERO_FATTURA INT;
    DECLARE ANNO INT;
    DECLARE ACCOMPAGNATORIA_OLD CHAR(1);
    DECLARE ACCOMPAGNATORIA_NEW CHAR(1);
    DECLARE DESCRIZIONE_LOG VARCHAR(255) DEFAULT '';
    DECLARE DESCRIZIONE_RIPRISTINO VARCHAR(255) DEFAULT '';
    DECLARE DESCRIZIONE_SPOSTAMENTO VARCHAR(255) DEFAULT ''; 
	    
    DECLARE CursorVoci CURSOR FOR 
        SELECT voci_fatture.ID_PRODOTTO, 
               voci_fatture.QUANTITA, 
               fatture.ID_MAGAZZINO, 
               fatture.NUMERO, 
               fatture.ANNO, 
               magazzini.DESCRIZIONE
                        FROM voci_fatture
          JOIN fatture ON fatture.CHIAVE = voci_fatture.ID_FATTURA
          JOIN magazzini ON magazzini.CHIAVE = fatture.ID_MAGAZZINO
                       WHERE voci_fatture.ID_FATTURA = OLD.CHIAVE;

  DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINITO = TRUE;
  

    SET ACCOMPAGNATORIA_OLD = OLD.ACCOMPAGNATORIA;
    SET ACCOMPAGNATORIA_NEW = NEW.ACCOMPAGNATORIA;

    IF OLD.ID_MAGAZZINO <> NEW.ID_MAGAZZINO THEN
        SET FINITO = FALSE;
    OPEN CursorVoci;
        LoopMagazzino: LOOP
            FETCH CursorVoci INTO ID_PRODOTTO, QUANTITA_PRODOTTO, ID_MAGAZZINO, NUMERO_FATTURA, ANNO, DESCRIZIONE_MAGAZZINO;
            IF FINITO THEN LEAVE LoopMagazzino; END IF;
            
            SELECT DESCRIZIONE 
				  INTO DESCRIZIONE_MAGAZZINO 
				  FROM magazzini 
				 WHERE CHIAVE = OLD.ID_MAGAZZINO;
            
            IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = 0 THEN
                SET DESCRIZIONE_RIPRISTINO = CONCAT('Modificato magazzino in avviso fattura accompagnatoria n. ', OLD.CHIAVE,'.
Ripristino quantità vecchio magazzino - ', DESCRIZIONE_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_RIPRISTINO = CONCAT('Modificato magazzino in fattura accompagnatoria n. ', NUMERO_FATTURA, '/', ANNO,'.
Ripristino quantità vecchio magazzino - ', DESCRIZIONE_MAGAZZINO);
      END IF;
            
            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, OLD.ID_MAGAZZINO, QUANTITA_PRODOTTO);
                        
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, OLD.ID_MAGAZZINO, QUANTITA_PRODOTTO, DESCRIZIONE_RIPRISTINO);
            
            SELECT DESCRIZIONE 
				  INTO DESCRIZIONE_NUOVO_MAGAZZINO 
				  FROM magazzini 
				 WHERE CHIAVE = NEW.ID_MAGAZZINO;
				
				IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = 0 THEN
                SET DESCRIZIONE_SPOSTAMENTO = CONCAT('Modificato magazzino in avviso fattura accompagnatoria n. ', OLD.CHIAVE,'.
Spostamento quantità nuovo magazzino - ', DESCRIZIONE_NUOVO_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_SPOSTAMENTO = CONCAT('Modificato magazzino in fattura accompagnatoria n. ', NUMERO_FATTURA, '/', ANNO,'.
Spostamento quantità nuovo magazzino - ', DESCRIZIONE_NUOVO_MAGAZZINO);
            END IF;
                
            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, NEW.ID_MAGAZZINO, -QUANTITA_PRODOTTO);
                
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, NEW.ID_MAGAZZINO, -QUANTITA_PRODOTTO, DESCRIZIONE_SPOSTAMENTO);
        END LOOP;
      CLOSE CursorVoci;
  END IF;
  
    IF ACCOMPAGNATORIA_OLD = 'T' AND ACCOMPAGNATORIA_NEW <> 'T' THEN
        SET FINITO = FALSE;
        OPEN CursorVoci;
        LoopAccomp1: LOOP
            FETCH CursorVoci INTO ID_PRODOTTO, QUANTITA_PRODOTTO, ID_MAGAZZINO, NUMERO_FATTURA, ANNO, DESCRIZIONE_MAGAZZINO;
            IF FINITO THEN LEAVE LoopAccomp1; END IF;

            IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = 0 THEN
                SET DESCRIZIONE_LOG = CONCAT('Ripristino quantità da avviso fattura ', OLD.CHIAVE, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_LOG = CONCAT('Ripristino quantità da fattura accompagnatoria N.', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            END IF;

            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, ID_MAGAZZINO, QUANTITA_PRODOTTO, DESCRIZIONE_LOG);

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, ID_MAGAZZINO, QUANTITA_PRODOTTO);
        END LOOP;
        CLOSE CursorVoci;
    END IF;

    IF ACCOMPAGNATORIA_OLD <> 'T' AND ACCOMPAGNATORIA_NEW = 'T' THEN
        SET FINITO = FALSE;
    OPEN CursorVoci;
        LoopAccomp2: LOOP
            FETCH CursorVoci INTO ID_PRODOTTO, QUANTITA_PRODOTTO, ID_MAGAZZINO, NUMERO_FATTURA, ANNO, DESCRIZIONE_MAGAZZINO;
            IF FINITO THEN LEAVE LoopAccomp2; END IF;

            IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = 0 THEN
                SET DESCRIZIONE_LOG = CONCAT('Rimozione quantità per avviso fattura ', OLD.CHIAVE, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_LOG = CONCAT('Rimozione quantità per fattura accompagnatoria N.', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
      END IF;
                  
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, ID_MAGAZZINO, QUANTITA_PRODOTTO * (-1), DESCRIZIONE_LOG);
        
            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, ID_MAGAZZINO, QUANTITA_PRODOTTO * (-1));
        END LOOP;
      CLOSE CursorVoci;
  END IF;
  
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
fatture_insolute_pregresse
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_PAGAMENTO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTO_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MOVIMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NO_PRIMA_NOTA	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ALLEGATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_FATTURE_INSOLUTE_PREGRESSE_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
FK_FATTURE_INSOLUTE_PREGRESSE_ID_CONTO_PAGAMENTO	ID_CONTO_PAGAMENTO	conti_correnti_casse	CHIAVE	
FK_FATTURE_INSOLUTE_PREGRESSE_ID_MOVIMENTO	ID_MOVIMENTO	movimenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
fatture_insolute_pregresse_fornitori
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_PAGAMENTO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTO_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MOVIMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NO_PRIMA_NOTA	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_FATTURE_INSOLUTE_PREGRESSE_FORNITORI_ID_CONTO	ID_CONTO_PAGAMENTO	conti_correnti_casse	CHIAVE	
FK_FATTURE_INSOLUTE_PREGRESSE_FORNITORI_ID_FORNITORE	ID_FORNITORE	fornitori	CHIAVE	
FK_FATTURE_INSOLUTE_PREGRESSE_FORNITORI_ID_MOVIMENTO	ID_MOVIMENTO	movimenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
fatture_passive
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IBAN	__TRUE__	varchar(27)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
OGGETTO	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
TOTALE_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IS_FATTURA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ESPORTATA_COMMERCIALISTA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RICEVUTA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_FATTURE_PASSIVE_FORNITORE	ID_FORNITORE	fornitori	CHIAVE	
FK3_FATTURE_PASSIVE_PROVINCE	PROVINCIA_FATTURAZIONE	province	CHIAVE	
FK_FATTURE_PASSIVE_MAGAZZINO	ID_MAGAZZINO	magazzini	CHIAVE	
FK_FATTURE_PASSIVE_NAZIONE_EM_PIVA	NAZIONE_EM_PIVA	nazioni	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
fatture_passive_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE ID_PRODOTTO INT;
    DECLARE QUANTITA_PRODOTTO INT;
    DECLARE FINITO INT DEFAULT FALSE;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
    DECLARE DESCRIZIONE_NUOVO_MAGAZZINO VARCHAR(255);
    DECLARE NUMERO_FATTURA VARCHAR(255);
    DECLARE ANNO INT;
    DECLARE DESCRIZIONE_LOG VARCHAR(255) DEFAULT '';
    DECLARE DESCRIZIONE_RIPRISTINO VARCHAR(255) DEFAULT '';
    DECLARE DESCRIZIONE_SPOSTAMENTO VARCHAR(255) DEFAULT ''; 
	    
    DECLARE CursorVoci CURSOR FOR 
        SELECT (SELECT prodotti.CHIAVE
					   FROM prodotti
					  WHERE prodotti.CODICE = voci_fatture_passive.CODICE_ARTICOLO) AS ID_PRODOTTO,
		  			voci_fatture_passive.QUANTITA, 
               fatture_passive.ID_MAGAZZINO, 
               fatture_passive.NUMERO, 
               fatture_passive.ANNO, 
               magazzini.DESCRIZIONE
          FROM voci_fatture_passive
          JOIN fatture_passive ON fatture_passive.CHIAVE = voci_fatture_passive.ID_FATTURA_PASSIVA
          JOIN magazzini ON magazzini.CHIAVE = fatture_passive.ID_MAGAZZINO
         WHERE voci_fatture_passive.ID_FATTURA_PASSIVA = OLD.CHIAVE;

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINITO = TRUE;

    IF OLD.ID_MAGAZZINO <> NEW.ID_MAGAZZINO THEN
        SET FINITO = FALSE;
        OPEN CursorVoci;
        LoopMagazzino: LOOP
            FETCH CursorVoci INTO ID_PRODOTTO, QUANTITA_PRODOTTO, ID_MAGAZZINO, NUMERO_FATTURA, ANNO, DESCRIZIONE_MAGAZZINO;
            IF FINITO THEN LEAVE LoopMagazzino; END IF;
            
            SELECT DESCRIZIONE 
				  INTO DESCRIZIONE_MAGAZZINO 
				  FROM magazzini 
				 WHERE CHIAVE = OLD.ID_MAGAZZINO;
                        
				IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
                SET DESCRIZIONE_RIPRISTINO = CONCAT('Modificato magazzino in avviso fattura passiva n. ', OLD.CHIAVE,'.
Ripristino quantità vecchio magazzino - ', DESCRIZIONE_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_RIPRISTINO = CONCAT('Modificato magazzino in fattura passiva n. ', NUMERO_FATTURA, '/', ANNO,'.
Ripristino quantità vecchio magazzino - ', DESCRIZIONE_MAGAZZINO);
            END IF;
            
            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, OLD.ID_MAGAZZINO, (QUANTITA_PRODOTTO * 100));
				            
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, OLD.ID_MAGAZZINO, (QUANTITA_PRODOTTO * 100), DESCRIZIONE_RIPRISTINO);


            
            SELECT DESCRIZIONE 
				  INTO DESCRIZIONE_NUOVO_MAGAZZINO 
				  FROM magazzini 
				 WHERE CHIAVE = NEW.ID_MAGAZZINO;
				             
				IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
                SET DESCRIZIONE_SPOSTAMENTO = CONCAT('Modificato magazzino in avviso fattura passiva n. ', OLD.CHIAVE,'.
Spostamento quantità nuovo magazzino - ', DESCRIZIONE_NUOVO_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_SPOSTAMENTO = CONCAT('Modificato magazzino in fattura passiva n. ', NUMERO_FATTURA, '/', ANNO,'.
Spostamento quantità nuovo magazzino - ', DESCRIZIONE_NUOVO_MAGAZZINO);
            END IF;

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, NEW.ID_MAGAZZINO, (-QUANTITA_PRODOTTO * 100));

            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, NEW.ID_MAGAZZINO, (-QUANTITA_PRODOTTO * 100), DESCRIZIONE_SPOSTAMENTO);
            
        END LOOP;
        CLOSE CursorVoci;
    END IF;

END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
fatture_passive_importate
##CAMPI_TABELLA
NOME_FILE	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_PASSIVA	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALLEGATO_XML	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
NOME_FILE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ID_FATTURA_PASSIVA	ID_FATTURA_PASSIVA	fatture_passive	CHIAVE	
##END_FOREIGN_KEY
##UNIQUE_KEY
##CAMPI_UNIQUE_KEY
ID_FATTURA_PASSIVA	
##END_CAMPI_UNIQUE_KEY
ID_FATTURA_PASSIVA	
##END_UNIQUE_KEY
##END_TABELLA 
##TABELLA
filiali_clienti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SEDE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CLIENTE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOME	__FALSE__	varchar(100)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ZONA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
REGISTRO_ANTINCENDIO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
POSIZIONE_REGISTRO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
POSIZIONE_CHIAVI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
FILIALE_DISATTIVATA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ALERT_CHIAVI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
LAT_IND	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
LONG_IND	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_FILIALI_CLIENTE	CLIENTE	clienti	CHIAVE	
FK_FILIALI_NAZIONI	NAZIONE	nazioni	CHIAVE	
FK_FILIALI_PROVINCIA	PROVINCIA	province	CHIAVE	
FK_FILIALI_ZONA	ZONA	zone	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
filiali_clienti_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
    IF NEW.FILIALE_DISATTIVATA != OLD.FILIALE_DISATTIVATA THEN
        INSERT INTO log_attivazioni_filiali (CHIAVE, FILIALE,DATA_ORA, FILIALE_DISATTIVATA)
        VALUES(GET_NEW_KEY(),NEW.CHIAVE, NOW(), NEW.FILIALE_DISATTIVATA);
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
filiali_orari
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FILIALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORARIO_DAL1	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORARIO_DAL2	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORARIO_AL1	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORARIO_AL2	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CHIAVE_NEGATIVA_PRECEDENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_RAPPORTO_CREAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
APERTO_DOMENICA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
APERTO_LUNEDI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
APERTO_MARTEDI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
APERTO_MERCOLEDI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
APERTO_GIOVEDI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
APERTO_VENERDI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
APERTO_SABATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_ORARI_ID_FILIALE	ID_FILIALE	filiali_clienti	CHIAVE	
FK_ORARI_ID_RAPPORTO	ID_RAPPORTO_CREAZIONE	rapporti_intervento	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
filiali_telefono
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FILIALE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EMAIL	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
TELEFONO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
EMAIL_PER_AVVISO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
TELEFONO_PER_AVVISO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PER_RAPPORTI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_FILIALI_TELEFONO_ID_FILIALE	ID_FILIALE	filiali_clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
fornitori
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FORNITORE	__TRUE__	tinytext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TITOLO	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INARCASSA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
REA_UFFICIO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_REA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAPITALE_SOCIALE	__TRUE__	bigint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SOCIO_UNICO_REA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO_LIQUIDAZIONE_REA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
REA_PRESENTE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EMITTENTE_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PRESSO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_SPEDIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_SPEDIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_SPEDIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_SPEDIZIONE	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_SPEDIZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_SPEDIZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BANCA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IBAN	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BIC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
SWIFT	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ID_CONTO_CORRENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PEC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BANCA_APPOGGIO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TIPO_AUTOFATTURA	__TRUE__	enum('E','I','S','A','F','P')	__FALSE__	__CAMPO_VUOTO__	E	__NULL__	
REGIME_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	RF01	__NULL__	
TIPO_RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	2	__NULL__	
IVA_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_PROVINCIA_FATTURAZIONE	PROVINCIA_FATTURAZIONE	province	CHIAVE	
FK3_FORNITORI_PROVINCIA_DEST	PROVINCIA_SPEDIZIONE	province	CHIAVE	
FK_FORNITORI_ID_CONTO_CORRENTE	ID_CONTO_CORRENTE	conti_correnti_casse	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
fornitori_telefono
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TELEFONO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PRINCIPALE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EMAIL	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_FORNITORI_TELEFONO_ID_FORNITORE	ID_FORNITORE	fornitori	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
identificativi_dispositivi
##CAMPI_TABELLA
IDENTIFICATIVO	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_ULTIMO_LOG	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_TECNICO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BLOCCATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
IDENTIFICATIVO	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_IDENTIFICATIVI_DISPOSITIVO_ID_TECNICO	ID_TECNICO	utenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
impostazioni
##CAMPI_TABELLA
IVA_SUGGERITA	__TRUE__	smallint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTA_ACCONTO	__TRUE__	smallint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ESIGIBILITA_IVA	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO_MESSA_IN_OPERA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	2023	__NULL__	
ANNO_PRIMA_FATTURA	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	2023	__NULL__	
NUMERO_PRIMA_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
ANNO_PRIMA_FATTURA_BANCO	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	2023	__NULL__	
NUMERO_PRIMA_FATTURA_BANCO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
ANNO_PRIMA_NOTA_DI_CREDITO	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	2023	__NULL__	
NUMERO_PRIMA_NOTA_DI_CREDITO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
SPESE_DI_TRASPORTO_SUGGERITE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COSTO_BOLLO_SUGGERITO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
IMPOSTA_DI_BOLLO_IMPOSTAZIONI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	Imposta di bollo assolta in modo virtuale ai sensi dell'art.15 del D.P.R. 642/1972 e del D.M. 17/06/2014	__NULL__	
UNITA_DI_MISURA_SUGGERITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ULTIMO_CODICE_FORNITORE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ULTIMO_CODICE_CLIENTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
LOGO_AZIENDA	__TRUE__	blob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERAZIONE_PRIMI_GIORNI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
ANNO_PRIMO_DDT	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	2023	__NULL__	
NUMERO_PRIMO_DDT	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
ANNO_PRIMO_PREVENTIVO	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	2023	__NULL__	
NUMERO_PRIMO_PREVENTIVO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
NOTA_PER_SUPERAMENTO_SOGLIA_ESENZIONE_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
STILE_STRINGHE	__TRUE__	enum('U','L','-')	__FALSE__	__CAMPO_VUOTO__	-	__NULL__	
ERRORE_IMPORTAZIONE_PASSIVE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ULTIMA_DATA_CARICATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
OGGETTO_EMAIL_DOPO_SDI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CORPO_EMAIL_DOPO_SDI	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_MESI_PER_FATTURE_INSOLUTE_PER_CONDOMINI	__TRUE__	smallint	__FALSE__	__CAMPO_VUOTO__	12	__NULL__	
NUMERO_MESI_PER_FATTURE_INSOLUTE_PER_PRIVATI	__TRUE__	smallint	__FALSE__	__CAMPO_VUOTO__	12	__NULL__	
CONFIGURAZIONE_MAIL_SOLLECITI_PRIMO_LIVELLO	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CONFIGURAZIONE_MAIL_SOLLECITI_SECONDO_LIVELLO	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CONFIGURAZIONE_MAIL_SOLLECITI_TERZO_LIVELLO	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO_PRIMO_PREVENTIVO_MULTI	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	2024	__NULL__	
NUMERO_PRIMO_PREVENTIVO_MULTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
ERRORE_INVIO_TRAMITE_EMAIL_RAPPORTI	__TRUE__	longtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
VISIBILITA_RAPPORTI_INTERVENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	10	__NULL__	
OGGETTO_EMAIL_PRIMO_SOLLECITO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
OGGETTO_EMAIL_SECONDO_SOLLECITO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
OGGETTO_EMAIL_TERZO_SOLLECITO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
OGGETTO_EMAIL_PREVENTIVI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
OGGETTO_EMAIL_PREVENTIVI_DA_ANOMALIE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CORPO_EMAIL_PREVENTIVI	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CORPO_EMAIL_PREVENTIVI_DA_ANOMALIE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
GENERAZIONE_PREVENTIVO_COLLAUDO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	T	__NULL__	
MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO_PRIMA_NOTA_DEBITO	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	2023	__NULL__	
NUMERO_PRIMA_NOTA_DEBITO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
ESPORTAZIONE_MANUALE_FATTURE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
OGGETTO_EMAIL_FATTURE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CORPO_EMAIL_FATTURE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CORPO_EMAIL_AUTORAPPORTI	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO_PRIMO_DOC	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	2026	__NULL__	
NUMERO_PRIMO_DOC	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
##END_CAMPI_TABELLA
##FOREIGN_KEY
FK_IMPOSTAZIONI_ID_MAGAZZINO	MAGAZZINO	magazzini	CHIAVE	
FK_IMPOSTAZIONI_UNITA_DI_MISURA_SUGGERITA	UNITA_DI_MISURA_SUGGERITA	unita_di_misura	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
impostazioni_amministrazione
##CAMPI_TABELLA
USERNAME_MY_SOND	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PASSWORD_MY_SOND	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COD_AZIENDA_MY_SOND	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MAIL_SYSTEM_ADMINISTRATOR	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_HOST_AVVISI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_PORT_AVVISI	__TRUE__	smallint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_SECURE_AVVISI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_AUTH_AVVISI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
SMTP_USER_AVVISI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_PASSWORD_AVVISI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_FROM_MAIL_AVVISI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_FROM_NAME_AVVISI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_HOST_FATTURE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_PORT_FATTURE	__TRUE__	smallint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_SECURE_FATTURE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_AUTH_FATTURE	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
SMTP_USER_FATTURE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_PASSWORD_FATTURE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_FROM_MAIL_FATTURE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_FROM_NAME_FATTURE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMAP_SOLLECITI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMAP_AVVISI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMAP_FATTURE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_HOST_SOLLECITI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_PORT_SOLLECITI	__TRUE__	smallint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_SECURE_SOLLECITI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_AUTH_SOLLECITI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_USER_SOLLECITI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_PASSWORD_SOLLECITI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_FROM_MAIL_SOLLECITI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SMTP_FROM_NAME_SOLLECITI	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##END_TABELLA 
##TABELLA
impostazioni_maps
##CAMPI_TABELLA
LAT_IND	__TRUE__	bigint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
LONG_IND	__TRUE__	bigint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ZOOM	__TRUE__	bigint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DALLE	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	09:00:00	__NULL__	
ALLE	__TRUE__	time	__FALSE__	__CAMPO_VUOTO__	18:00:00	__NULL__	
PREZZO_MINIMO_USCITA_TECNICO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	100	__NULL__	
##END_CAMPI_TABELLA
##END_TABELLA 
##TABELLA
incassi_confermati
##CAMPI_TABELLA
ID_RAPPORTO	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
ID_RAPPORTO	ID_FATTURA	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_INC_CONF_FATTURA	ID_FATTURA	fatture	CHIAVE	
FK_INC_CONF_RAPPORTO	ID_RAPPORTO	rapporti_intervento	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_attivazioni_filiali
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
FILIALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_ORA	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
FILIALE_DISATTIVATA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_FILIALE_LOG_ATTIVAZIONI_FILIALI	FILIALE	filiali_clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_autofatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_AUTOFATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	blob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_UTENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_LOG_AUTOFATT_ID_AUTOFATT	ID_AUTOFATTURA	autofatture	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_email
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESTINATARIO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CCN	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
OGGETTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CORPO_EMAIL	__TRUE__	longtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TIPO_DOCUMENTO	__TRUE__	enum('F','P','N','R','M','I')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_INSERIMENTO	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ERRORE_INVIO_EMAIL	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MITTENTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_AMMINISTRATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_LOG_EMAIL_ID_AMMINISTRATORE	ID_AMMINISTRATORE	amministratori	CHIAVE	
FK_LOG_EMAIL_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_fatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	blob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_UTENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_LOG_FATTURE_ID_FATTURE	ID_FATTURA	fatture	CHIAVE	
FK_LOG_FATTURE_ID_UTENTI	ID_UTENTE	utenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_generazione_fatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTRATTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
FATTURAZIONE_EFFETTUATA	__TRUE__	enum('A','P','S')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_LOG_GENERATORE_ID_FATTURA	ID_FATTURA	fatture	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_magazzino
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	blob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_MAGAZZINO	ID_MAGAZZINO	magazzini	CHIAVE	
FK_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_note_di_credito
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_NOTA_DI_CREDITO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	blob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_UTENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_LOG_NOTA_DI_CREDITO_ID_NOTA_DI_CREDITO	ID_NOTA_DI_CREDITO	note_di_credito	CHIAVE	
FK_LOG_NOTA_DI_CREDITO_ID_UTENTE	ID_UTENTE	utenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_preventivi
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PREVENTIVO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	blob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_UTENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_LOG_PREVENTIVI_ID_PREVENTIVO	ID_PREVENTIVO	preventivi	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
log_solleciti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_AMMINISTRATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_LOG_SOLLECITI_AMMINISTRATORI	ID_AMMINISTRATORE	amministratori	CHIAVE	
FK_LOG_SOLLECITI_CLIENTI	ID_CLIENTE	clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
magazzini
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
messaggi
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TITOLO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TESTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMMAGINE	__TRUE__	mediumblob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
mod_pagamento
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
modifiche_anagrafiche_importazione
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_RAPPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TIPOLOGIA	__TRUE__	enum('C','A','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROPOSTA_MODIFICA	__TRUE__	longtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_MODIFICHE_ANAGRAFICA_ID_RAPPORTO	ID_RAPPORTO	rapporti_intervento	CHIAVE	
##END_FOREIGN_KEY
##UNIQUE_KEY
##CAMPI_UNIQUE_KEY
ID_RAPPORTO	TIPOLOGIA	
##END_CAMPI_UNIQUE_KEY
ID_RAPPORTO	
##END_UNIQUE_KEY
##END_TABELLA 
##TABELLA
movimenti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SOSPESO	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CONTO_CORRENTE_PRELIEVO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CONTO_CORRENTE_VERSAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CATEGORIA_MOVIMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_CHIUSURA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NO_PRIMA_NOTA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_MOVIMENTO_CONTO_CORRENTE_PRELIEVO	CONTO_CORRENTE_PRELIEVO	conti_correnti_casse	CHIAVE	
FK2_MOVIMENTI_CONTI_CORRENTI_VERSAMENTI	CONTO_CORRENTE_VERSAMENTO	conti_correnti_casse	CHIAVE	
FK3_MOVIMENTI_CATEGORIA_MOVIMENTI	ID_CATEGORIA_MOVIMENTO	cat_movimenti	CHIAVE	
FK_MOV_CLIENTI	ID_CLIENTE	clienti	CHIAVE	
FK_MOV_FORNITORI	ID_FORNITORE	fornitori	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
movimenti_magazzini
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MAGAZZINO_CEDENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MAGAZZINO_RICEVENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_MOVIMENTI_MAGAZZINI_MAGAZZINO_CEDENTE	ID_MAGAZZINO_CEDENTE	magazzini	CHIAVE	
FK_MOVIMENTI_MAGAZZINI_MAGAZZINO_RICEVENTE	ID_MAGAZZINO_RICEVENTE	magazzini	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
nazioni
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOME	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SIGLA	__TRUE__	char(2)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
note_di_credito
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_PAGAMENTO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
INDIRIZZO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_DESTINAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COND_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ESIGIBILITA_IVA	__TRUE__	enum('D','I','S')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IBAN	__TRUE__	varchar(27)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BANCA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BIC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
SWIFT	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ID_CONTO_CORRENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COD_ENTE_SDI	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
PEC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ENTE_PUBBLICO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
COD_UFFICIO_DEST	__TRUE__	varchar(6)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
INVIATA_ALLO_SDI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_CONTO_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CAUSALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DOCUMENTO_CORRELATO	__TRUE__	enum('N','O','C')	__FALSE__	__CAMPO_VUOTO__	N	__NULL__	
CUP	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CIG	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CONVENZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
VOCE_DI_RIFERIMENTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DOCUMENTO_NR	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_DOCUMENTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE_PAGAMENTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
INVIATA_TRAMITE_EMAIL	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NO_PRIMA_NOTA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
SCALATA_IN_FATTURA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
XML_DA_INVIARE_A_SDI	__TRUE__	mediumtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_CREAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO_ESPORTAZIONE_MANUALE	__TRUE__	enum('C','D','I','Z')	__FALSE__	__CAMPO_VUOTO__	C	__NULL__	
DATA_ESPORTAZIONE_MANUALE_INVIATO	__TRUE__	datetime	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_NOTA_CREDITO_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
FK2_NOTA_CREDITO_PROVINCIA_FATT	PROVINCIA_FATTURAZIONE	province	CHIAVE	
FK3_NOTA_CREDITO_PROVINCIA_DEST	PROVINCIA_DESTINAZIONE	province	CHIAVE	
FK4_NOTA_CREDITO_COND_PAGAMENTO	COND_PAGAMENTO	cond_pagamento	CHIAVE	
FK_NOTA_CREDITO_ID_FATTURA_CREAZIONE	ID_FATTURA_CREAZIONE	fatture	CHIAVE	
FK_NOTA_CREDITO_NAZIONE_DEST	NAZIONE_DESTINAZIONE	nazioni	CHIAVE	
FK_NOTA_CREDITO_NAZIONE_EM_PIVA	NAZIONE_EM_PIVA	nazioni	CHIAVE	
FKNOTA_CREDITO_ID_CAUSALE	ID_CAUSALE	causali	CHIAVE	
##END_FOREIGN_KEY
##UNIQUE_KEY
##CAMPI_UNIQUE_KEY
NUMERO	ANNO	
##END_CAMPI_UNIQUE_KEY
UNQ_NOTE_DI_CREDITO	
##END_UNIQUE_KEY
##END_TABELLA 
##TABELLA
note_rate_fattura
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_INSOLUTA_PREGRESSA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_NOTE_RATE_FATTURA_ID_FATTURA	ID_FATTURA	fatture	CHIAVE	
FK_NOTE_RATE_FATTURA_INSOLUTA_PREGRESSA	ID_FATTURA_INSOLUTA_PREGRESSA	fatture_insolute_pregresse	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
preventivi
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTRATTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO	__TRUE__	enum('C','S','R')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
NAZIONE_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
INDIRIZZO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_DESTINAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COND_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ESIGIBILITA_IVA	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IBAN	__TRUE__	varchar(27)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAUSALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTO_CORRENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BANCA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BIC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
SWIFT	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
IS_INVIATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ENTE_PUBBLICO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PEC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
COD_ENTE_SDI	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
COD_UFFICIO_DEST	__TRUE__	varchar(6)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
NUMERO_REVISIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	10	__NULL__	
ID_RAPPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FILIALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROGRAMMA_PROSSIMA_VISITA	__TRUE__	enum('F','T')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
CIG	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CUP	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CONVENZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DATA_DOCUMENTO	__TRUE__	varchar(50)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DOCUMENTO_NR	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
VOCE_DI_RIFERIMENTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DOCUMENTO_CORRELATO	__TRUE__	enum('N','O','C')	__FALSE__	__CAMPO_VUOTO__	N	__NULL__	
ID_DDT_USCENTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_DDT_ENTRANTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_ZONA_SPEDIZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_PREV_FILIALE	ID_FILIALE	filiali_clienti	CHIAVE	
FK_PREV_ID_ZONA_SPED	ID_ZONA_SPEDIZIONE	zone	CHIAVE	
FK_PREVENT_DDT	ID_DDT_USCENTI	ddt_uscenti	CHIAVE	
FK_PREVENTIVI_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
FK_PREVENTIVI_ID_COND_PAGAMENTO	COND_PAGAMENTO	cond_pagamento	CHIAVE	
FK_PREVENTIVI_ID_DDT_ENTRANTI	ID_DDT_ENTRANTI	ddt_entranti	CHIAVE	
FK_PREVENTIVI_ID_FATTURA	ID_FATTURA	fatture	CHIAVE	
FK_PREVENTIVI_ID_PROVINCIA_DEST	PROVINCIA_DESTINAZIONE	province	CHIAVE	
FK_PREVENTIVI_ID_PROVINCIA_FATT	PROVINCIA_FATTURAZIONE	province	CHIAVE	
FK_PREVENTIVI_NAZIONE_DEST	NAZIONE_DESTINAZIONE	nazioni	CHIAVE	
FK_PREVENTIVI_NAZIONE_EM_PIVA	NAZIONE_EM_PIVA	nazioni	CHIAVE	
##END_FOREIGN_KEY
##UNIQUE_KEY
##CAMPI_UNIQUE_KEY
NUMERO	ANNO	
##END_CAMPI_UNIQUE_KEY
UNQ_PREVENTIVI	
##END_UNIQUE_KEY
##END_TABELLA 
##TABELLA
preventivi_multi_sezione
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PREVENTIVO_MULTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_PREV_MULTI_SEZIONE_ID_PREVENTIVO	ID_PREVENTIVO_MULTI	preventivi_multiparametrici	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
preventivi_multi_soluzioni
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_SEZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PREVENTIVO_MULTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ACCETTATA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_PREV_MULTI_SOLUZIONI_ID_PREV_MULTI	ID_PREVENTIVO_MULTI	preventivi_multiparametrici	CHIAVE	
FK_PREV_MULTI_SOLUZIONI_ID_SEZIONE	ID_SEZIONE	preventivi_multi_sezione	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
preventivi_multi_voci_soluzione
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_SOLUZIONE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORDINAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PREVENTIVO_MULTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_PRODOTTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NATURA_PAGAMENTO	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_VOCI_SOLUZIONI_ID_PREV_MULTI	ID_PREVENTIVO_MULTI	preventivi_multiparametrici	CHIAVE	
FK_VOCI_SOLUZIONI_ID_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
FK_VOCI_SOLUZIONI_ID_SOLUZIONE	ID_SOLUZIONE	preventivi_multi_soluzioni	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
preventivi_multiparametrici
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTRATTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO	__TRUE__	enum('C','S','R')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
INDIRIZZO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_FATTURAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_FATTURAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_FATTURAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PARTITA_IVA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NAZIONE_EM_PIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
NAZIONE_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	110	__NULL__	
INDIRIZZO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NR_CIVICO_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROVINCIA_DESTINAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COMUNE_DESTINAZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAP_DESTINAZIONE	__TRUE__	varchar(5)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
COND_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ESIGIBILITA_IVA	__TRUE__	char(1)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IBAN	__TRUE__	varchar(27)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CAUSALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTO_CORRENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BANCA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BIC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
SWIFT	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
IS_INVIATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ENTE_PUBBLICO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PEC	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
COD_ENTE_SDI	__TRUE__	varchar(10)	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
COD_UFFICIO_DEST	__TRUE__	varchar(6)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
NUMERO_REVISIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	10	__NULL__	
ID_RAPPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FILIALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROGRAMMA_PROSSIMA_VISITA	__TRUE__	enum('F','T')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
CIG	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CUP	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
CONVENZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DATA_DOCUMENTO	__TRUE__	varchar(50)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DOCUMENTO_NR	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
VOCE_DI_RIFERIMENTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
DOCUMENTO_CORRELATO	__TRUE__	enum('N','O','C')	__FALSE__	__CAMPO_VUOTO__	N	__NULL__	
ID_DDT_USCENTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_DDT_ENTRANTI	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PREVENTIVO_CONFERMA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PROPOSTA_INTERVENTO_IMMEDIATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
RIFIUTATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
PRIMO_PREVENTIVO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MESE_GENERAZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_CREAZIONE	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_ZONA_SPEDIZIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_PREV_MULTI_FILIALE	ID_FILIALE	filiali_clienti	CHIAVE	
FK_PREV_MULTI_ID_CONFERMA	ID_PREVENTIVO_CONFERMA	preventivi	CHIAVE	
FK_PREV_MULTI_ID_ZONA_SPED	ID_ZONA_SPEDIZIONE	zone	CHIAVE	
FK_PREVENT_MULTI_DDT	ID_DDT_USCENTI	ddt_uscenti	CHIAVE	
FK_PREVENTIVI_MULTI_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
FK_PREVENTIVI_MULTI_ID_COND_PAGAMENTO	COND_PAGAMENTO	cond_pagamento	CHIAVE	
FK_PREVENTIVI_MULTI_ID_DDT_ENTRANTI	ID_DDT_ENTRANTI	ddt_entranti	CHIAVE	
FK_PREVENTIVI_MULTI_ID_FATTURA	ID_FATTURA	fatture	CHIAVE	
FK_PREVENTIVI_MULTI_ID_PROVINCIA_DEST	PROVINCIA_DESTINAZIONE	province	CHIAVE	
FK_PREVENTIVI_MULTI_ID_PROVINCIA_FATT	PROVINCIA_FATTURAZIONE	province	CHIAVE	
FK_PREVENTIVI_MULTI_ID_RAPPORTO	ID_RAPPORTO	rapporti_intervento	CHIAVE	
FK_PREVENTIVI_MULTI_NAZIONE_DEST	NAZIONE_DESTINAZIONE	nazioni	CHIAVE	
FK_PREVENTIVI_MULTI_NAZIONE_EM_PIVA	NAZIONE_EM_PIVA	nazioni	CHIAVE	
##END_FOREIGN_KEY
##UNIQUE_KEY
##CAMPI_UNIQUE_KEY
NUMERO	ANNO	NUMERO_REVISIONE	PRIMO_PREVENTIVO	
##END_CAMPI_UNIQUE_KEY
UNQ_PREVENTIVI	
##END_UNIQUE_KEY
##END_TABELLA 
##TABELLA
prodotti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_SETTORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PREZZO_IMPONIBILE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PREZZO_ULTIMO_ACQUISTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
DATA_ULTIMO_ACQUISTO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA_SUGGERITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	1	__NULL__	
SOGLIA_ALLARME	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
PRODOTTO_COMPOSTO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_SETTORE	ID_SETTORE	settori	CHIAVE	
FK2_PRODOTTI_UDM	UNITA_DI_MISURA	unita_di_misura	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
prodotti_after_insert	INSERT	AFTER	
##CORPO_TRIGGERS
BEGIN      
   INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, QUANTITA, DESCRIZIONE)
   VALUES (GET_NEW_KEY(), NOW(), NEW.CHIAVE, 0, 'Aggiunto nuovo prodotto');
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
prodotti_x_montaggio
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MONTAGGIO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PRODOTTO_SEMPLICE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_MONTAGGIO	ID_MONTAGGIO	prodotti	CHIAVE	
FK2_PRODOTTO_SEMPLICE	PRODOTTO_SEMPLICE	prodotti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
prodotti_x_movimenti_magazzini
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MOVIMENTO_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_PRODOTTI_MOVIMENTI_MAGAZZINI_ID_MOVIMENTO	ID_MOVIMENTO_MAGAZZINO	movimenti_magazzini	CHIAVE	
FK_PRODOTTI_MOVIMENTI_MAGAZZINI_PRODOTTI	ID_PRODOTTO	prodotti	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
movimenti_prodotti_magazzini_after_insert	INSERT	AFTER	
##CORPO_TRIGGERS
BEGIN
    CALL CORREGGI_QUANTITA_MAGAZZINO(NEW.ID_PRODOTTO, NEW.QUANTITA_PRODOTTO, NEW.ID_MOVIMENTO_MAGAZZINO, FALSE, FALSE);
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
movimenti_prodotti_magazzini_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
  DECLARE DELTA_Q INT(11) DEFAULT (NEW.QUANTITA_PRODOTTO - OLD.QUANTITA_PRODOTTO);  
  
  IF DELTA_Q <> 0 THEN
		CALL CORREGGI_QUANTITA_MAGAZZINO(NEW.ID_PRODOTTO, DELTA_Q, NEW.ID_MOVIMENTO_MAGAZZINO, FALSE, TRUE);
  END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
movimenti_prodotti_magazzini_after_delete	DELETE	AFTER	
##CORPO_TRIGGERS
BEGIN
    CALL CORREGGI_QUANTITA_MAGAZZINO(OLD.ID_PRODOTTO, OLD.QUANTITA_PRODOTTO, OLD.ID_MOVIMENTO_MAGAZZINO, TRUE, FALSE);
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
province
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOME	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TARGA	__TRUE__	char(2)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_REGIONE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_PROVINCE_ID_REGIONE	ID_REGIONE	regioni	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
qnt_x_magazzino
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA_MAGAZZINO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SOGLIA_ALLARME	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_QNT_MAGAZZINO	ID_MAGAZZINO	magazzini	CHIAVE	
FK_QNT_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
qnt_x_magazzino_after_insert	INSERT	AFTER	
##CORPO_TRIGGERS
BEGIN
    INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, QUANTITA, DESCRIZIONE)
    VALUES (GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, NEW.QUANTITA_MAGAZZINO,
        CONCAT('Aggiunta quantità in magazzino ',
		  			(SELECT DESCRIZIONE 
		  			   FROM magazzini 
				     WHERE CHIAVE = NEW.ID_MAGAZZINO)));
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
rate_fattura
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_PAGAMENTO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTO_CASSE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MOVIMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NO_PRIMA_NOTA	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
IS_RITENUTA_ACCONTO	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
IS_NON_SCARICATA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK2_RATE_CONTO_CASSE	ID_CONTO_CASSE	conti_correnti_casse	CHIAVE	
FK_RATE_FATTURE_FATTURA	ID_FATTURA	fatture	CHIAVE	
FK_RATE_FATTURE_ID_MOVIMENTO	ID_MOVIMENTO	movimenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
rate_fatture_passive
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_PASSIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_SCADENZA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_PAGAMENTO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MOD_PAGAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTO_CASSA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_MOVIMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NO_PRIMA_NOTA	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_RATE_ID_FATTURE_PASSIVE	ID_FATTURA_PASSIVA	fatture_passive	CHIAVE	
FK_RATE_PASSIVA_ID_CONT_CASS	ID_CONTO_CASSA	conti_correnti_casse	CHIAVE	
FK_RATE_PASSIVA_ID_MOVIMENTO	ID_MOVIMENTO	movimenti	CHIAVE	
FK_RATE_PASSIVA_MOD_PAG	ID_MOD_PAGAMENTO	mod_pagamento	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
rate_note
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_NOTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_PAGAMENTO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_CONTO_CASSE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCALATA_IN_FATTURA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_RATE_NOTA_NOTA_DI_CREDITO	ID_NOTA	note_di_credito	CHIAVE	
FK_RATE_NOTA_CONTO_CASSE	ID_CONTO_CASSE	conti_correnti_casse	CHIAVE	
FK_RATE_NOTA_FATTURA	ID_FATTURA	fatture	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
regioni
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
riepiloghi_fatture_passive
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_PASSIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ARROTONDAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPONIBILE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPOSTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_RIEPILOGHI_ID_FATT_PASS	ID_FATTURA_PASSIVA	fatture_passive	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
ritenute_acconto_clienti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__TRUE__	varchar(50)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	mediumtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CERTIFICATA	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_RITENUTE_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
ritenute_cliente
##CAMPI_TABELLA
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	smallint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RITENUTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IDENTIFICATIVO_FISCALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##FOREIGN_KEY
FK1_RITENUTA_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
ritenute_fatture_passive
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_PASSIVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TIPO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ALIQUOTA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_RITENUTE_ID_FATT_PASS	ID_FATTURA_PASSIVA	fatture_passive	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
saldi_chiusure_annuali
##CAMPI_TABELLA
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ANNO	__TRUE__	year	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CIFRA_CHIUSURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FORNITORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DARE_CHIUSURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
AVERE_CHIUSURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##FOREIGN_KEY
FK_SALDI_CHISURE_ANNUALI_ID_CLIENTE	ID_CLIENTE	clienti	CHIAVE	
FK_SALDI_CHIUSURE_ID_FORNITORE	ID_FORNITORE	fornitori	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
scadenzario
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__FALSE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
GESTITO	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_RAPPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_RAPPORTO	ID_RAPPORTO	rapporti_intervento	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
scissione_dei_pagamenti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(50)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
settori
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IS_SERVIZI	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
status_download_dati_gdpr
##CAMPI_TABELLA
DATA_RICHIESTA	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
STATO_DOWNLOAD	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##END_TABELLA 
##TABELLA
testi
##CAMPI_TABELLA
DESCRIZIONE_PREZZO_FISSO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	PREZZO FISSO	__NULL__	
DESCRIZIONE_CANONE_ANNUALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	QUOTA ANNUA NOLEGGIO	__NULL__	
MAIL_AVVISO_INTERVENTO_OGGETTO	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MAIL_AVVISO_INTERVENTO_FASCIA_ORARIA	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MAIL_AVVISO_INTERVENTO_DATA	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##END_TABELLA 
##TABELLA
titoli
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
token_rememberme
##CAMPI_TABELLA
TOKEN	__FALSE__	varchar(50)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UTENTE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA	__FALSE__	timestamp	__FALSE__	__CAMPO_VUOTO__	CURRENT_TIMESTAMP	__NULL__	
BROWSER	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CONTINENTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
TOKEN	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_TOKEN_REMEMBER_ME_UTENTE	UTENTE	utenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
tubi_co2
##CAMPI_TABELLA
ID_ATTREZZATURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
MATRICOLA	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##FOREIGN_KEY
FK_TUBI_CO2_ID_ATTREZZATURA	ID_ATTREZZATURA	attrezzature	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
unita_di_misura
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__FALSE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
utente_messaggio_letto
##CAMPI_TABELLA
ID_MESSAGGIO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_UTENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##FOREIGN_KEY
FK_MESSAGGI_LETTI_ID_MESSAGGIO	ID_MESSAGGIO	messaggi	CHIAVE	
FK_MESSAGGI_LETTI_ID_UTENTE	ID_UTENTE	utenti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
utenti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
USERNAME	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RAGIONE_SOCIALE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PASSWORD	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
EMAIL	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ROLE	__FALSE__	enum('A','D','T','S','L','C')	__FALSE__	__CAMPO_VUOTO__	D	__NULL__	
ELIMINATO	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
IMMAGINE	__TRUE__	mediumblob	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PRIMO_ACCESSO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	T	__NULL__	
ID_CLIENTE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_AMMINISTRATORE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_UTENTI_AMMINISTRATORI	ID_AMMINISTRATORE	amministratori	CHIAVE	
FK_UTENTI_CLIENTI	ID_CLIENTE	clienti	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
voci_autofatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_AUTOFATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORDINAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO_IVATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_PRODOTTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NATURA_PAGAMENTO	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_VOCI_AUTOFATTURE_ID_AUTOFATT	ID_AUTOFATTURA	autofatture	CHIAVE	
FK_VOCI_AUTOFATTURE_UNITA_DI_MISURA	UNITA_DI_MISURA	unita_di_misura	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
voci_ddt_entranti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_DDT	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORDINAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
CODICE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_DDT	ID_DDT	ddt_entranti	CHIAVE	
FK_UDM	UNITA_DI_MISURA	unita_di_misura	CHIAVE	
FK_VOCE_ENTR_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
voci_ddt_entranti_after_insert	INSERT	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE QUANTITAPRODOTTO INT DEFAULT NEW.QUANTITA;
    DECLARE NUMERO_DDT INT;
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
  
    SELECT ddt_entranti.NUMERO_DDT,
	 		  ddt_entranti.ANNO_DDT, 
			  ddt_entranti.ID_MAGAZZINO
      INTO NUMERO_DDT, ANNO, ID_MAGAZZINO
      FROM ddt_entranti
    WHERE ddt_entranti.CHIAVE = NEW.ID_DDT;
      
    SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
      FROM magazzini
     WHERE CHIAVE = ID_MAGAZZINO;

    CALL INCREMENTA_MAGAZZINO(NEW.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO);
      
    INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE) 
    VALUES (GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO, CONCAT('Aggiunta voce in DDT entrante N. ', NUMERO_DDT, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO));
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_ddt_entranti_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE DELTA_Q INT(11) DEFAULT (NEW.QUANTITA - OLD.QUANTITA);
    DECLARE NUMERO_DDT INT;
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
    
    SELECT ddt_entranti.NUMERO_DDT, ddt_entranti.ANNO_DDT, ddt_entranti.ID_MAGAZZINO
      INTO NUMERO_DDT, ANNO, ID_MAGAZZINO
      FROM ddt_entranti
      WHERE ddt_entranti.CHIAVE = NEW.ID_DDT;
      
    SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
      FROM magazzini
     WHERE CHIAVE = ID_MAGAZZINO;

    IF DELTA_Q <> 0 THEN
        CALL INCREMENTA_MAGAZZINO(OLD.ID_PRODOTTO, ID_MAGAZZINO, DELTA_Q);
        INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE) 
        VALUES (GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, ID_MAGAZZINO, DELTA_Q, CONCAT('Modificata voce in DDT entrante N. ', NUMERO_DDT, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO));
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_ddt_entranti_after_delete	DELETE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE QUANTITAPRODOTTO INT DEFAULT OLD.QUANTITA;
    DECLARE NUMERO_DDT INT;
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
  
    SELECT ddt_entranti.NUMERO_DDT,
           ddt_entranti.ANNO_DDT,
           ddt_entranti.ID_MAGAZZINO
      INTO NUMERO_DDT, ANNO, ID_MAGAZZINO
      FROM ddt_entranti
     WHERE ddt_entranti.CHIAVE = OLD.ID_DDT;
      
    SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
      FROM magazzini
     WHERE CHIAVE = ID_MAGAZZINO;

    CALL INCREMENTA_MAGAZZINO(OLD.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO * (-1));
    
    INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
    VALUES (GET_NEW_KEY(), NOW(), OLD.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO * (-1), CONCAT('Eliminata voce in DDT entrante N. ', NUMERO_DDT, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO));
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
voci_ddt_uscenti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_DDT	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORDINAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
CODICE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_VOCI_DDT	ID_DDT	ddt_uscenti	CHIAVE	
FK_UNITA_DI_MISURA_DDT	UNITA_DI_MISURA	unita_di_misura	CHIAVE	
FK_VOC_USC_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
voci_ddt_uscenti_after_insert	INSERT	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE QUANTITAPRODOTTO INT DEFAULT NEW.QUANTITA;
    DECLARE STATO_DDT CHAR(1);
    DECLARE NUMERO_DDT INT;
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);

    -- Prendo info DDT
    SELECT ddt_uscenti.STATO_DDT,
           ddt_uscenti.NUMERO_DDT,
           ddt_uscenti.ANNO_DDT,
           ddt_uscenti.ID_MAGAZZINO
    INTO STATO_DDT, NUMERO_DDT, ANNO, ID_MAGAZZINO
    FROM ddt_uscenti
    WHERE ddt_uscenti.CHIAVE = NEW.ID_DDT;  
    
    SELECT DESCRIZIONE 
    INTO DESCRIZIONE_MAGAZZINO
    FROM magazzini
    WHERE CHIAVE = ID_MAGAZZINO;

    -- Se DDT non ancora confermata → scala il prodotto inserito
    IF STATO_DDT <> 'A' THEN	
        CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(NEW.ID_PRODOTTO, ID_MAGAZZINO);

        UPDATE qnt_x_magazzino
        SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO - QUANTITAPRODOTTO
        WHERE ID_PRODOTTO = NEW.ID_PRODOTTO
          AND ID_MAGAZZINO = ID_MAGAZZINO;
    
        INSERT INTO log_magazzino (
            CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE
        ) VALUES (
            GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, ID_MAGAZZINO, -QUANTITAPRODOTTO,
            CONCAT('Uscita voce in DDT N. ', NUMERO_DDT,'/',ANNO,' - magazzino ', DESCRIZIONE_MAGAZZINO)
        );
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_ddt_uscenti_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE DELTA_Q INT DEFAULT (NEW.QUANTITA - OLD.QUANTITA);
    DECLARE STATO_DDT CHAR(1);
    DECLARE NUMERO_DDT INT;
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
    
    SELECT ddt_uscenti.STATO_DDT,
          ddt_uscenti.NUMERO_DDT,
           ddt_uscenti.ANNO_DDT,
           ddt_uscenti.ID_MAGAZZINO
      INTO STATO_DDT, NUMERO_DDT, ANNO, ID_MAGAZZINO
      FROM ddt_uscenti
    WHERE ddt_uscenti.CHIAVE = NEW.ID_DDT;  
    
    SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
      FROM magazzini
     WHERE CHIAVE = ID_MAGAZZINO;

    IF DELTA_Q <> 0 AND STATO_DDT <> 'A' THEN
        CALL INCREMENTA_MAGAZZINO(OLD.ID_PRODOTTO, ID_MAGAZZINO, DELTA_Q * (-1));
          
        INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
        VALUES (GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, ID_MAGAZZINO, DELTA_Q * (-1),
                CONCAT('Modificata voce in DDT N. ', NUMERO_DDT,'/',ANNO,' - magazzino ', DESCRIZIONE_MAGAZZINO));
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_ddt_uscenti_after_delete	DELETE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE QUANTITAPRODOTTO INT DEFAULT OLD.QUANTITA;
    DECLARE STATO_DDT CHAR(1);
    DECLARE NUMERO_DDT INT;
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
  
    SELECT ddt_uscenti.STATO_DDT,
            ddt_uscenti.NUMERO_DDT,
           ddt_uscenti.ANNO_DDT,
           ddt_uscenti.ID_MAGAZZINO
      INTO STATO_DDT, NUMERO_DDT, ANNO, ID_MAGAZZINO
      FROM ddt_uscenti
      WHERE ddt_uscenti.CHIAVE = OLD.ID_DDT;  
    
    SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
      FROM magazzini
     WHERE CHIAVE = ID_MAGAZZINO;

    IF STATO_DDT <> 'A' THEN
        CALL INCREMENTA_MAGAZZINO(OLD.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO);
        
        INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
        VALUES (GET_NEW_KEY(), NOW(), OLD.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO,
                CONCAT('Eliminata voce in DDT N. ', NUMERO_DDT,'/',ANNO,' - magazzino ', DESCRIZIONE_MAGAZZINO));
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
voci_doc_scarico_prodotti_composti
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_DOCUMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORDINAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	0	__NULL__	
CODICE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_DOCUMENTO	ID_DOCUMENTO	doc_scarico_prodotti_composti	CHIAVE	
FK1_UDM	UNITA_DI_MISURA	unita_di_misura	CHIAVE	
FK1_VOCE_ENTR_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
voci_scarico_prodotti_composti_after_insert	INSERT	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE ProdottoComposto CHAR(1);
    DECLARE FINITO INT DEFAULT 0;
    DECLARE QuantitaProdottoSemplice INT;
    DECLARE NomeProdottoSemplice VARCHAR(255);
    DECLARE NomeProdottoComposto VARCHAR(255);
    DECLARE IdProdottoSemplice INT;
    DECLARE CHIAVE_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);

    DECLARE CursorProdotti CURSOR FOR 
        SELECT QUANTITA, PRODOTTO_SEMPLICE
        FROM prodotti_x_montaggio
        WHERE ID_MONTAGGIO = NEW.ID_PRODOTTO;

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINITO = 1;

    -- Nome del prodotto composto
    SELECT DESCRIZIONE INTO NomeProdottoComposto
    FROM prodotti
    WHERE CHIAVE = NEW.ID_PRODOTTO;

    -- Prendo il magazzino dal documento
    SELECT ID_MAGAZZINO INTO CHIAVE_MAGAZZINO
    FROM doc_scarico_prodotti_composti
    WHERE CHIAVE = NEW.ID_DOCUMENTO;

    SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
    FROM magazzini
    WHERE CHIAVE = CHIAVE_MAGAZZINO;

    -- Controllo se è composto
    SELECT PRODOTTO_COMPOSTO
    INTO ProdottoComposto
    FROM prodotti
    WHERE CHIAVE = NEW.ID_PRODOTTO;

    -- Aumento quantità prodotto composto
    CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(NEW.ID_PRODOTTO, CHIAVE_MAGAZZINO);
    UPDATE qnt_x_magazzino
    SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO + NEW.QUANTITA
    WHERE ID_PRODOTTO = NEW.ID_PRODOTTO
      AND ID_MAGAZZINO = CHIAVE_MAGAZZINO;

    -- Inserimento log prodotto composto
    INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
    VALUES (GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, CHIAVE_MAGAZZINO, NEW.QUANTITA,
            CONCAT('Inserito prodotto composto "', NomeProdottoComposto, '" - magazzino "', DESCRIZIONE_MAGAZZINO, '"'));

    -- Se è composto → scala componenti
    IF ProdottoComposto = 'T' THEN
        OPEN CursorProdotti;

        LoopCursor: LOOP
            FETCH CursorProdotti INTO QuantitaProdottoSemplice, IdProdottoSemplice;

            IF FINITO = 1 THEN
                LEAVE LoopCursor;
            END IF;

            -- Nome componente
            SELECT DESCRIZIONE INTO NomeProdottoSemplice
            FROM prodotti
            WHERE CHIAVE = IdProdottoSemplice;

            CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(IdProdottoSemplice, CHIAVE_MAGAZZINO);

            -- Scala componenti
            UPDATE qnt_x_magazzino
            SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO - (QuantitaProdottoSemplice * NEW.QUANTITA)
            WHERE ID_PRODOTTO = IdProdottoSemplice
              AND ID_MAGAZZINO = CHIAVE_MAGAZZINO;

            -- Log componente
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), IdProdottoSemplice, CHIAVE_MAGAZZINO, -(QuantitaProdottoSemplice * NEW.QUANTITA),
                    CONCAT('Tolto componente "', NomeProdottoSemplice, '" per inserimento prodotto composto "', NomeProdottoComposto, '" - magazzino "', DESCRIZIONE_MAGAZZINO, '"'));

        END LOOP;

        CLOSE CursorProdotti;
    END IF;

END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_scarico_prodotti_composti_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE ProdottoComposto CHAR(1);
    DECLARE FINITO INT DEFAULT 0;
    DECLARE QuantitaProdottoSemplice INT;
    DECLARE NomeProdottoSemplice VARCHAR(255);
    DECLARE NomeProdottoComposto VARCHAR(255);
    DECLARE IdProdottoSemplice INT;
    DECLARE CHIAVE_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);
    DECLARE DELTA_Q INT DEFAULT (NEW.QUANTITA - OLD.QUANTITA);

    DECLARE CursorProdotti CURSOR FOR 
        SELECT QUANTITA, PRODOTTO_SEMPLICE
        FROM prodotti_x_montaggio
        WHERE ID_MONTAGGIO = NEW.ID_PRODOTTO;

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINITO = 1;

    -- Nome prodotto composto
    SELECT DESCRIZIONE INTO NomeProdottoComposto
    FROM prodotti
    WHERE CHIAVE = NEW.ID_PRODOTTO;

    -- Magazzino
    SELECT ID_MAGAZZINO INTO CHIAVE_MAGAZZINO
    FROM doc_scarico_prodotti_composti
    WHERE CHIAVE = NEW.ID_DOCUMENTO;

    SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
    FROM magazzini
    WHERE CHIAVE = CHIAVE_MAGAZZINO;

    -- Controllo se è composto
    SELECT PRODOTTO_COMPOSTO INTO ProdottoComposto
    FROM prodotti
    WHERE CHIAVE = NEW.ID_PRODOTTO;

    -- Aggiorno quantità prodotto composto
    CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(NEW.ID_PRODOTTO, CHIAVE_MAGAZZINO);

    UPDATE qnt_x_magazzino
    SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO + DELTA_Q
    WHERE ID_PRODOTTO = NEW.ID_PRODOTTO
      AND ID_MAGAZZINO = CHIAVE_MAGAZZINO;

    -- Log prodotto composto aggiornato
    INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
    VALUES (GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, CHIAVE_MAGAZZINO, DELTA_Q,
            CONCAT('Aggiornato prodotto composto "', NomeProdottoComposto, '" - quantità modificata di ', DELTA_Q, ' - magazzino "', DESCRIZIONE_MAGAZZINO, '"'));

    -- Se è composto → aggiorno componenti
    IF ProdottoComposto = 'T' THEN
        OPEN CursorProdotti;

        LoopCursor: LOOP
            FETCH CursorProdotti INTO QuantitaProdottoSemplice, IdProdottoSemplice;

            IF FINITO = 1 THEN
                LEAVE LoopCursor;
            END IF;

            -- Nome componente
            SELECT DESCRIZIONE INTO NomeProdottoSemplice
            FROM prodotti
            WHERE CHIAVE = IdProdottoSemplice;

            CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(IdProdottoSemplice, CHIAVE_MAGAZZINO);

            -- Aggiorno componenti
            UPDATE qnt_x_magazzino
            SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO - (QuantitaProdottoSemplice * DELTA_Q)
            WHERE ID_PRODOTTO = IdProdottoSemplice
              AND ID_MAGAZZINO = CHIAVE_MAGAZZINO;

            -- Log componente
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), IdProdottoSemplice, CHIAVE_MAGAZZINO, -(QuantitaProdottoSemplice * DELTA_Q),
                    CONCAT('Aggiornato componente "', NomeProdottoSemplice, '" per prodotto composto "', NomeProdottoComposto, '" - quantità modificata di ', QuantitaProdottoSemplice * DELTA_Q, ' - magazzino "', DESCRIZIONE_MAGAZZINO, '"'));

        END LOOP;

        CLOSE CursorProdotti;
    END IF;

END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_scarico_prodotti_composti_after_delete	DELETE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE ProdottoComposto CHAR(1);
    DECLARE FINITO INT DEFAULT 0;
    DECLARE QuantitaProdottoSemplice INT;
    DECLARE NomeProdottoSemplice VARCHAR(255);
    DECLARE NomeProdottoComposto VARCHAR(255);
    DECLARE IdProdottoSemplice INT;
    DECLARE CHIAVE_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255);

    DECLARE CursorProdotti CURSOR FOR 
        SELECT QUANTITA, PRODOTTO_SEMPLICE
        FROM prodotti_x_montaggio
        WHERE ID_MONTAGGIO = OLD.ID_PRODOTTO;

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINITO = 1;

    -- Nome prodotto composto
    SELECT DESCRIZIONE INTO NomeProdottoComposto
    FROM prodotti
    WHERE CHIAVE = OLD.ID_PRODOTTO;

    -- Magazzino
    SELECT ID_MAGAZZINO INTO CHIAVE_MAGAZZINO
    FROM doc_scarico_prodotti_composti
    WHERE CHIAVE = OLD.ID_DOCUMENTO;

    SELECT DESCRIZIONE INTO DESCRIZIONE_MAGAZZINO
    FROM magazzini
    WHERE CHIAVE = CHIAVE_MAGAZZINO;

    -- Controllo se è composto
    SELECT PRODOTTO_COMPOSTO INTO ProdottoComposto
    FROM prodotti
    WHERE CHIAVE = OLD.ID_PRODOTTO;

    -- Riduzione quantità prodotto composto
    CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(OLD.ID_PRODOTTO, CHIAVE_MAGAZZINO);

    UPDATE qnt_x_magazzino
    SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO - OLD.QUANTITA
    WHERE ID_PRODOTTO = OLD.ID_PRODOTTO
      AND ID_MAGAZZINO = CHIAVE_MAGAZZINO;

    -- Log prodotto composto eliminato
    INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
    VALUES (GET_NEW_KEY(), NOW(), OLD.ID_PRODOTTO, CHIAVE_MAGAZZINO, -OLD.QUANTITA,
            CONCAT('Rimosso prodotto composto "', NomeProdottoComposto, '" - magazzino "', DESCRIZIONE_MAGAZZINO, '"'));

    -- Se è composto → ripristino componenti
    IF ProdottoComposto = 'T' THEN
        OPEN CursorProdotti;

        LoopCursor: LOOP
            FETCH CursorProdotti INTO QuantitaProdottoSemplice, IdProdottoSemplice;

            IF FINITO = 1 THEN
                LEAVE LoopCursor;
            END IF;

            -- Nome componente
            SELECT DESCRIZIONE INTO NomeProdottoSemplice
            FROM prodotti
            WHERE CHIAVE = IdProdottoSemplice;

            CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(IdProdottoSemplice, CHIAVE_MAGAZZINO);

            -- Ripristino componenti
            UPDATE qnt_x_magazzino
            SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO + (QuantitaProdottoSemplice * OLD.QUANTITA)
            WHERE ID_PRODOTTO = IdProdottoSemplice
              AND ID_MAGAZZINO = CHIAVE_MAGAZZINO;

            -- Log componente
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), IdProdottoSemplice, CHIAVE_MAGAZZINO, QuantitaProdottoSemplice * OLD.QUANTITA,
                    CONCAT('Ripristinato componente "', NomeProdottoSemplice, '" per prodotto composto "', NomeProdottoComposto, '" - magazzino "', DESCRIZIONE_MAGAZZINO, '"'));

        END LOOP;

        CLOSE CursorProdotti;
    END IF;

END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
voci_fatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORDINAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO_IVATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_PRODOTTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NO_PRIMA_NOTA	__FALSE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
ID_FATTURA_ANTICIPO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NATURA_PAGAMENTO	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_VOCI_FATT_ANT	ID_FATTURA_ANTICIPO	fatture	CHIAVE	
FK_VOCI_FATT_ID_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
FK_VOCI_FATTURA_ID_FATTURA	ID_FATTURA	fatture	CHIAVE	
FK_VOCI_FATTURA_UDM	UNITA_DI_MISURA	unita_di_misura	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
voci_fattura_accompagnatoria_after_insert	INSERT	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE QUANTITAPRODOTTO INT DEFAULT NEW.QUANTITA;
    DECLARE ACCOMPAGNATORIA CHAR(1);
    DECLARE NUMERO_FATTURA INT;
    DECLARE DESCRIZIONE VARCHAR(255) DEFAULT '';
    DECLARE DA_BANCO CHAR(1);
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255) DEFAULT '';
      
      SELECT fatture.ACCOMPAGNATORIA,
            fatture.NUMERO,
            fatture.DA_BANCO,
           fatture.ANNO,
           fatture.ID_MAGAZZINO,
           magazzini.DESCRIZIONE
      INTO ACCOMPAGNATORIA, NUMERO_FATTURA, DA_BANCO, ANNO, ID_MAGAZZINO, DESCRIZIONE_MAGAZZINO
      FROM fatture
           JOIN magazzini ON fatture.ID_MAGAZZINO = magazzini.CHIAVE
      WHERE fatture.CHIAVE = NEW.ID_FATTURA;
    
      IF DA_BANCO = 'T' THEN
        IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = 0 THEN
            SET DESCRIZIONE = CONCAT('Aggiunta voce in avviso fattura ', NEW.ID_FATTURA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
        ELSE
            SET DESCRIZIONE = CONCAT('Aggiunta voce in fattura accompagnatoria N. B', NUMERO_FATTURA,'/',ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
        END IF;
      ELSE
        IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = 0 THEN
            SET DESCRIZIONE = CONCAT('Aggiunta voce in avviso fattura ', NEW.ID_FATTURA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
        ELSE
            SET DESCRIZIONE = CONCAT('Aggiunta voce in fattura accompagnatoria N.', NUMERO_FATTURA,'/',ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
        END IF;
      END IF;
      
      IF ACCOMPAGNATORIA = 'T' THEN
        CALL INCREMENTA_MAGAZZINO(NEW.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO * (-1));
        INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
        VALUES (GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO * (-1), DESCRIZIONE);
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_fatture_accompagnatoria_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE DELTA_Q INT DEFAULT (NEW.QUANTITA - OLD.QUANTITA);
    DECLARE ACCOMPAGNATORIA CHAR(1);
    DECLARE NUMERO_FATTURA INT DEFAULT 0;
    DECLARE DA_BANCO CHAR(1) DEFAULT 'F';
    DECLARE DESCRIZIONE VARCHAR(255) DEFAULT '';
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255) DEFAULT '';

    SELECT fatture.ACCOMPAGNATORIA,
          fatture.NUMERO,
          fatture.DA_BANCO,
           fatture.ANNO,
           fatture.ID_MAGAZZINO,
           magazzini.DESCRIZIONE
      INTO ACCOMPAGNATORIA, NUMERO_FATTURA, DA_BANCO, ANNO, ID_MAGAZZINO, DESCRIZIONE_MAGAZZINO
      FROM fatture
           JOIN magazzini ON fatture.ID_MAGAZZINO = magazzini.CHIAVE
    WHERE fatture.CHIAVE = NEW.ID_FATTURA;
          
    IF DELTA_Q <> 0 THEN  
        IF ACCOMPAGNATORIA = 'T' THEN
            IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = 0 THEN
                SET DESCRIZIONE = CONCAT('Modificata voce in avviso fattura ', NEW.ID_FATTURA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            ELSE
            IF DA_BANCO = 'T' THEN
                    SET DESCRIZIONE = CONCAT('Modificata voce in fattura accompagnatoria N. B', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            ELSE
                    SET DESCRIZIONE = CONCAT('Modificata voce in fattura accompagnatoria N.', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
                END IF;
            END IF;

            CALL INCREMENTA_MAGAZZINO(OLD.ID_PRODOTTO, ID_MAGAZZINO, DELTA_Q * (-1));
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), NEW.ID_PRODOTTO, ID_MAGAZZINO, DELTA_Q * (-1), DESCRIZIONE);
        END IF;
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_fattura_accompagnatoria_after_delete	DELETE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE QUANTITAPRODOTTO INT DEFAULT OLD.QUANTITA;
    DECLARE ACCOMPAGNATORIA CHAR(1) DEFAULT 'F';
    DECLARE NUMERO_FATTURA INT DEFAULT 0;
    DECLARE DA_BANCO CHAR(1) DEFAULT 'F';
    DECLARE DESCRIZIONE VARCHAR(255) DEFAULT '';
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255) DEFAULT '';
  
    SELECT fatture.ACCOMPAGNATORIA,
          fatture.NUMERO,
          fatture.DA_BANCO,
           fatture.ANNO,
           fatture.ID_MAGAZZINO,
           magazzini.DESCRIZIONE
      INTO ACCOMPAGNATORIA, NUMERO_FATTURA, DA_BANCO, ANNO, ID_MAGAZZINO, DESCRIZIONE_MAGAZZINO
      FROM fatture
           JOIN magazzini ON fatture.ID_MAGAZZINO = magazzini.CHIAVE
    WHERE fatture.CHIAVE = OLD.ID_FATTURA;
  
    IF ACCOMPAGNATORIA = 'T' THEN
        IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = 0 THEN
            SET DESCRIZIONE = CONCAT('Eliminata voce in avviso fattura ', OLD.ID_FATTURA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
        ELSE
        IF DA_BANCO = 'T' THEN
                SET DESCRIZIONE = CONCAT('Eliminata voce in fattura accompagnatoria N. B', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
        ELSE
                SET DESCRIZIONE = CONCAT('Eliminata voce in fattura accompagnatoria N.', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            END IF;
        END IF;
    
        CALL INCREMENTA_MAGAZZINO(OLD.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO);
        INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
        VALUES (GET_NEW_KEY(), NOW(), OLD.ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO, DESCRIZIONE);
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
voci_fatture_passive
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA_PASSIVA	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NUMERO_LINEA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
BENE_SERVIZIO	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
PREZZO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
TOTALE	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOTE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO1	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO2	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO3	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_ARTICOLO	__TRUE__	varchar(50)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
GESTITO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_VOCE_FATTURA_PASSIVA	ID_FATTURA_PASSIVA	fatture_passive	CHIAVE	
FK_VOCE_FATTURA_PASSIVA_ID_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
##END_FOREIGN_KEY
##TRIGGERS
voci_fatture_passive_after_insert	INSERT	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE QUANTITAPRODOTTO INT DEFAULT NEW.QUANTITA;
    DECLARE NUMERO_FATTURA CHAR(255);
    DECLARE ANNO INT;
    DECLARE ID_PRODOTTO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255) DEFAULT '';
    DECLARE DESCRIZIONE_LOG VARCHAR(255) DEFAULT '';
    
      SELECT fatture_passive.NUMERO,
           fatture_passive.ANNO,
           fatture_passive.ID_MAGAZZINO,
           magazzini.DESCRIZIONE
      INTO NUMERO_FATTURA, ANNO, ID_MAGAZZINO, DESCRIZIONE_MAGAZZINO
        FROM fatture_passive
           JOIN magazzini ON fatture_passive.ID_MAGAZZINO = magazzini.CHIAVE
      WHERE fatture_passive.CHIAVE = NEW.ID_FATTURA_PASSIVA;
      
      SELECT prodotti.CHIAVE
        INTO ID_PRODOTTO
        FROM prodotti
      WHERE prodotti.CODICE = NEW.CODICE_ARTICOLO;
      
    IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
        SET DESCRIZIONE_LOG = CONCAT('Aggiunta voce in avviso fattura passiva ', NEW.ID_FATTURA_PASSIVA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
    ELSE
        SET DESCRIZIONE_LOG = CONCAT('Aggiunta voce in fattura passiva N. ', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
    END IF;

    CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO * (+100));
      
    INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
    VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO * (+100), DESCRIZIONE_LOG);
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_fatture_passive_after_update	UPDATE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE DELTA_Q INT DEFAULT (NEW.QUANTITA - OLD.QUANTITA);
    DECLARE ID_PRODOTTO_NEW INT;
    DECLARE ID_PRODOTTO_OLD INT;
    DECLARE NUMERO_FATTURA CHAR(255);
    DECLARE ANNO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255) DEFAULT '';
    DECLARE DESCRIZIONE_LOG VARCHAR(255) DEFAULT '';

    SELECT fatture_passive.NUMERO,
           fatture_passive.ANNO,
           fatture_passive.ID_MAGAZZINO,
           magazzini.DESCRIZIONE,
           (SELECT prodotti.CHIAVE FROM prodotti WHERE prodotti.CODICE = NEW.CODICE_ARTICOLO) AS ID_PRODOTTO_NEW,
           (SELECT prodotti.CHIAVE FROM prodotti WHERE prodotti.CODICE = OLD.CODICE_ARTICOLO) AS ID_PRODOTTO_OLD
      INTO NUMERO_FATTURA, ANNO, ID_MAGAZZINO, DESCRIZIONE_MAGAZZINO, ID_PRODOTTO_NEW, ID_PRODOTTO_OLD
      FROM fatture_passive
           JOIN magazzini ON fatture_passive.ID_MAGAZZINO = magazzini.CHIAVE
    WHERE fatture_passive.CHIAVE = OLD.ID_FATTURA_PASSIVA;
    
    IF OLD.CODICE_ARTICOLO IS NOT NULL AND NEW.CODICE_ARTICOLO IS NOT NULL THEN

      IF OLD.CODICE_ARTICOLO = NEW.CODICE_ARTICOLO THEN 

        IF DELTA_Q <> 0 THEN
        
                IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
                    SET DESCRIZIONE_LOG = CONCAT('Modificata voce in avviso fattura passiva ', OLD.ID_FATTURA_PASSIVA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
                ELSE
                    SET DESCRIZIONE_LOG = CONCAT('Modificata voce in fattura passiva N. ', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
                END IF;

                CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO_OLD, ID_MAGAZZINO, DELTA_Q * 100);
          
                INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
                VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO_OLD, ID_MAGAZZINO, DELTA_Q * 100, DESCRIZIONE_LOG);
          
        END IF;
        ELSE
            IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
                SET DESCRIZIONE_LOG = CONCAT('Eliminata voce in avviso fattura passiva ', OLD.ID_FATTURA_PASSIVA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_LOG = CONCAT('Eliminata voce in fattura passiva N. ', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            END IF;

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO_OLD, ID_MAGAZZINO, OLD.QUANTITA * -100);
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO_OLD, ID_MAGAZZINO, OLD.QUANTITA * -100, DESCRIZIONE_LOG);

            IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
                SET DESCRIZIONE_LOG = CONCAT('Aggiunta voce in avviso fattura passiva ', NEW.ID_FATTURA_PASSIVA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_LOG = CONCAT('Aggiunta voce in fattura passiva N. ', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            END IF;

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO_NEW, ID_MAGAZZINO, NEW.QUANTITA * 100);
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO_NEW, ID_MAGAZZINO, NEW.QUANTITA * 100, DESCRIZIONE_LOG);
      END IF;
    ELSE
      IF OLD.CODICE_ARTICOLO IS NOT NULL THEN
            IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
                SET DESCRIZIONE_LOG = CONCAT('Eliminata voce in avviso fattura passiva ', OLD.ID_FATTURA_PASSIVA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_LOG = CONCAT('Eliminata voce in fattura passiva N. ', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            END IF;

            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO_OLD, ID_MAGAZZINO, OLD.QUANTITA * -100);
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO_OLD, ID_MAGAZZINO, OLD.QUANTITA * -100, DESCRIZIONE_LOG);
        ELSE
            IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
                SET DESCRIZIONE_LOG = CONCAT('Aggiunta voce in avviso fattura passiva ', NEW.ID_FATTURA_PASSIVA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            ELSE
                SET DESCRIZIONE_LOG = CONCAT('Aggiunta voce in fattura passiva N. ', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
            END IF;
      
            CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO_NEW, ID_MAGAZZINO, NEW.QUANTITA * 100);
            INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
            VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO_NEW, ID_MAGAZZINO, NEW.QUANTITA * 100, DESCRIZIONE_LOG);
      END IF;
    END IF;
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##TRIGGERS
voci_fatture_passive_after_delete	DELETE	AFTER	
##CORPO_TRIGGERS
BEGIN
    DECLARE QUANTITAPRODOTTO INT DEFAULT OLD.QUANTITA;
    DECLARE NUMERO_FATTURA CHAR(255);
    DECLARE ANNO INT;
    DECLARE ID_PRODOTTO INT;
    DECLARE ID_MAGAZZINO INT;
    DECLARE DESCRIZIONE_MAGAZZINO VARCHAR(255) DEFAULT '';
    DECLARE DESCRIZIONE_LOG VARCHAR(255) DEFAULT '';
    
      SELECT fatture_passive.NUMERO,
           fatture_passive.ANNO,
           fatture_passive.ID_MAGAZZINO,
           magazzini.DESCRIZIONE
      INTO NUMERO_FATTURA, ANNO, ID_MAGAZZINO, DESCRIZIONE_MAGAZZINO
        FROM fatture_passive
           JOIN magazzini ON fatture_passive.ID_MAGAZZINO = magazzini.CHIAVE
      WHERE fatture_passive.CHIAVE = OLD.ID_FATTURA_PASSIVA;
      
      SELECT prodotti.CHIAVE
        INTO ID_PRODOTTO
        FROM prodotti
      WHERE prodotti.CODICE = OLD.CODICE_ARTICOLO;
      
    IF NUMERO_FATTURA IS NULL OR NUMERO_FATTURA = '' THEN
        SET DESCRIZIONE_LOG = CONCAT('Eliminata voce in avviso fattura passiva ', OLD.ID_FATTURA_PASSIVA, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
    ELSE
        SET DESCRIZIONE_LOG = CONCAT('Eliminata voce in fattura passiva N. ', NUMERO_FATTURA, '/', ANNO, ' - magazzino ', DESCRIZIONE_MAGAZZINO);
    END IF;

    CALL INCREMENTA_MAGAZZINO(ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO * (-100));
      
    INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA, DESCRIZIONE)
    VALUES (GET_NEW_KEY(), NOW(), ID_PRODOTTO, ID_MAGAZZINO, QUANTITAPRODOTTO * (-100), DESCRIZIONE_LOG);
END
##END_CORPO_TRIGGERS
##END_TRIGGERS
##END_TABELLA 
##TABELLA
voci_note_di_credito
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_NOTA_DI_CREDITO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORDINAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO_IVATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_PRODOTTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NATURA_PAGAMENTO	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK1_ID_NOTA_DI_CREDITO	ID_NOTA_DI_CREDITO	note_di_credito	CHIAVE	
FK_NOTE_DI_CREDITO_UDM	UNITA_DI_MISURA	unita_di_misura	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
voci_preventivi
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PREVENTIVO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ORDINAMENTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
UNITA_DI_MISURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
QUANTITA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IVA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IMPORTO_IVATO	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
SCONTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
CODICE_PRODOTTO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NATURA_PAGAMENTO	__TRUE__	tinyint	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_PRODOTTO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_VOCI_PREVENTIVI_ID_PRODOTTO	ID_PRODOTTO	prodotti	CHIAVE	
FK_voci_preventivi_preventivi	ID_PREVENTIVO	preventivi	CHIAVE	
voci_preventivi_ibfk_2	UNITA_DI_MISURA	unita_di_misura	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
voci_preventivi_predefinite
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__CAMPO_VUOTO__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##TABELLA
xml_autofatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_AUTOFATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
XML_BODY	__TRUE__	mediumtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_INVIO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOME_FILE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RISULTATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_XML_AUTOFATT_ID_AUTOFATT	ID_AUTOFATTURA	autofatture	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
xml_fatture
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_FATTURA	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
XML_BODY	__TRUE__	mediumtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_INVIO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOME_FILE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RISULTATO	__TRUE__	text	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_XML_FATTURE_FATTURA	ID_FATTURA	fatture	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
xml_note_di_credito
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
ID_NOTA_DI_CREDITO	__TRUE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
XML_BODY	__TRUE__	mediumtext	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DATA_INVIO	__TRUE__	date	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
NOME_FILE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
RISULTATO	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##FOREIGN_KEY
FK_XML_NOTE_ID_NOTA	ID_NOTA_DI_CREDITO	note_di_credito	CHIAVE	
##END_FOREIGN_KEY
##END_TABELLA 
##TABELLA
zone
##CAMPI_TABELLA
CHIAVE	__FALSE__	int	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
DESCRIZIONE	__TRUE__	varchar(255)	__FALSE__	__CAMPO_VUOTO__	__NULL__	__NULL__	
IS_ZTL	__TRUE__	enum('T','F')	__FALSE__	__CAMPO_VUOTO__	F	__NULL__	
##END_CAMPI_TABELLA
##PRIMARY_KEY
CHIAVE	
##END_PRIMARY_KEY
##END_TABELLA 
##LISTA_GENERATORI
CHIAVE	gen_key	
##END_LISTA_GENERATORI
##LISTA_PROCEDURE
ASSEGNA_NUMERO_FATTURA	PROCEDURE	__NULL__	
##BODY
BEGIN
    DECLARE NumeroPrimiGiorni INT;
    DECLARE FatturaDaBanco CHAR;
    DECLARE NotaDiDebito CHAR;
    DECLARE NuovaData DATE;
    DECLARE AnnoPrimaFattura INT;
    DECLARE NumeroPrimaFattura INT;
    DECLARE AnnoPrimaFatturaDaBanco INT;
    DECLARE NumeroPrimaFatturaDaBanco INT;
    DECLARE AnnoPrimaNotaDebito INT;
    DECLARE NumeroPrimaNotaDebito INT;
    DECLARE MaxFatture INT;
    DECLARE NuovoNumero INT;
    DECLARE NumeroEsistente INT;

    SELECT NUMERAZIONE_PRIMI_GIORNI,
           ANNO_PRIMA_FATTURA,
           NUMERO_PRIMA_FATTURA,
           ANNO_PRIMA_FATTURA_BANCO,
           NUMERO_PRIMA_FATTURA_BANCO,
           ANNO_PRIMA_NOTA_DEBITO,
           NUMERO_PRIMA_NOTA_DEBITO
      FROM impostazioni
     INTO NumeroPrimiGiorni,
          AnnoPrimaFattura,
          NumeroPrimaFattura,
          AnnoPrimaFatturaDaBanco,
          NumeroPrimaFatturaDaBanco,
          AnnoPrimaNotaDebito,
          NumeroPrimaNotaDebito;

    SELECT DA_BANCO, NOTA_DI_DEBITO
      FROM fatture
     WHERE CHIAVE = CHIAVE_FATTURA
     INTO FatturaDaBanco, NotaDiDebito;

    SET NuovaData = CURDATE();

    IF FatturaDaBanco <> 'T' AND NotaDiDebito <> 'T' THEN
        IF DAY(NuovaData) <= NumeroPrimiGiorni THEN
            SET NuovaData = LAST_DAY(NuovaData - INTERVAL 1 MONTH);
        END IF;
    END IF;

    SELECT MAX(NUMERO)
      FROM fatture
     WHERE EXTRACT(YEAR FROM DATA) = EXTRACT(YEAR FROM NuovaData)
       AND NUMERO IS NOT NULL
       AND DA_BANCO = FatturaDaBanco 
		 AND NOTA_DI_DEBITO = NotaDiDebito
    INTO MaxFatture;

    IF MaxFatture IS NULL THEN
	    IF NotaDiDebito <> 'T' AND FatturaDaBanco <> 'T' THEN
	        IF AnnoPrimaFattura = EXTRACT(YEAR FROM NuovaData) THEN
	            SET NuovoNumero = NumeroPrimaFattura;
	        ELSE
	            SET NuovoNumero = 1;
	        END IF;
	    ELSEIF FatturaDaBanco = 'T' THEN
	        IF AnnoPrimaFatturaDaBanco = EXTRACT(YEAR FROM NuovaData) THEN
	            SET NuovoNumero = NumeroPrimaFatturaDaBanco;
	        ELSE
	            SET NuovoNumero = 1;
	        END IF;
	    ELSE
	        IF AnnoPrimaNotaDebito = EXTRACT(YEAR FROM NuovaData) THEN
	            SET NuovoNumero = NumeroPrimaNotaDebito;
	        ELSE
	            SET NuovoNumero = 1;
	        END IF;
	    END IF;
 	 ELSE
	     SET NuovoNumero = MaxFatture + 1;
	 END IF;


    SELECT NUMERO
      FROM fatture
     WHERE CHIAVE = CHIAVE_FATTURA
     INTO NumeroEsistente;

    IF NumeroEsistente IS NOT NULL THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Numero fattura presente.';
    END IF;

    UPDATE fatture
       SET NUMERO = NuovoNumero,
           DATA = NuovaData,
           ANNO = EXTRACT(YEAR FROM NuovaData)
     WHERE CHIAVE = CHIAVE_FATTURA;

END
##END_BODY
##PARAMETRI
CHIAVE_FATTURA	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
ASSEGNA_NUMERO_NOTA_DI_CREDITO	PROCEDURE	__NULL__	
##BODY
BEGIN
 DECLARE ConteggioNote INT;
 DECLARE AnnoNota INT;
 DECLARE NuovoNumero INT;
 DECLARE AnnoPrimaNota INT;
 DECLARE NumeroPrimaNota INT;

 UPDATE note_di_credito
   SET DATA = CURDATE()
 WHERE CHIAVE = CHIAVE_NOTA_DI_CREDITO;
       

 SELECT EXTRACT(YEAR FROM DATA)
   FROM note_di_credito
  WHERE CHIAVE = CHIAVE_NOTA_DI_CREDITO
   INTO AnnoNota;
  
 SELECT COUNT(*)
   FROM note_di_credito
  WHERE EXTRACT(YEAR FROM DATA) = AnnoNota
    AND NUMERO IS NOT NULL
   INTO ConteggioNote;
  
 IF ConteggioNote = 0 THEN
  SELECT ANNO_PRIMA_NOTA_DI_CREDITO
    FROM impostazioni
   INTO AnnoPrimaNota;
  SELECT NUMERO_PRIMA_NOTA_DI_CREDITO
    FROM impostazioni
    INTO NumeroPrimaNota;
  IF(AnnoPrimaNota = AnnoNota) THEN
    SET NuovoNumero = NumeroPrimaNota;
  ELSE
    SET NuovoNumero = 1;
  END IF;
 ELSE
   SELECT MAX(NUMERO)
     FROM note_di_credito
    WHERE EXTRACT(YEAR FROM DATA) = AnnoNota
     INTO NuovoNumero;
   IF NuovoNumero IS NULL THEN
      SET NuovoNumero = 1;
   ELSE
      SET NuovoNumero = NuovoNumero + 1;
   END IF;
  END IF;


UPDATE note_di_credito
   SET NUMERO = NuovoNumero,
       ANNO = EXTRACT(YEAR FROM CURDATE())
 WHERE CHIAVE = CHIAVE_NOTA_DI_CREDITO;
END
##END_BODY
##PARAMETRI
CHIAVE_NOTA_DI_CREDITO	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
CLIENTI_CON_FATTURE_INSOLUTE	PROCEDURE	__NULL__	
##BODY
BEGIN
DECLARE NUMERO_MESI_PER_CONDOMINI INT DEFAULT 0;
  DECLARE NUMERO_MESI_PER_PRIVATI INT DEFAULT 0;
  
  SELECT NUMERO_MESI_PER_FATTURE_INSOLUTE_PER_CONDOMINI, NUMERO_MESI_PER_FATTURE_INSOLUTE_PER_PRIVATI
    INTO NUMERO_MESI_PER_CONDOMINI, NUMERO_MESI_PER_PRIVATI
    FROM impostazioni;
  
  SELECT clienti.CHIAVE AS CHIAVE,
         clienti.RAGIONE_SOCIALE AS RAGIONE_SOCIALE, 
         clienti.IS_A_CONDOMINIO, 
         clienti.CODICE_CLIENTE AS CODICE_CLIENTE
    FROM clienti
         INNER JOIN fatture ON clienti.CHIAVE = fatture.ID_CLIENTE
   WHERE fatture.CHIAVE IN (SELECT fatture.CHIAVE	
                              FROM fatture
                             WHERE fatture.NUMERO IS NOT NULL
									    AND fatture.CHIAVE IN (SELECT rate_fattura.ID_FATTURA
                                                        FROM rate_fattura
                                                       WHERE rate_fattura.DATA_PAGAMENTO IS NULL
																		   AND rate_fattura.ID_MOVIMENTO IS NULL))
     AND CURDATE() > DATE_ADD(fatture.DATA, INTERVAL IF(clienti.IS_A_CONDOMINIO = 'T', NUMERO_MESI_PER_CONDOMINI, NUMERO_MESI_PER_PRIVATI) MONTH)
     AND (CHIAVE_CLIENTE = -1 OR fatture.ID_CLIENTE = CHIAVE_CLIENTE)
     AND clienti.CHIAVE IN (SELECT contratti.ID_CLIENTE
                              FROM contratti
                             WHERE contratti.NON_CONFERMATO = 'F'
                               AND contratti.DISDETTATO = 'F'
                               AND contratti.SOSPENSIONE_TEMPORANEA = 'F'
                               AND contratti.TIPOLOGIA = 'M')
UNION
  SELECT clienti.CHIAVE AS CHIAVE,
         clienti.RAGIONE_SOCIALE AS RAGIONE_SOCIALE, 
         clienti.IS_A_CONDOMINIO, 
         clienti.CODICE_CLIENTE AS CODICE_CLIENTE
    FROM fatture_insolute_pregresse
         LEFT OUTER JOIN clienti ON fatture_insolute_pregresse.ID_CLIENTE = clienti.CHIAVE
   WHERE CURDATE() > DATE_ADD(fatture_insolute_pregresse.DATA, INTERVAL IF(clienti.IS_A_CONDOMINIO = 'T', NUMERO_MESI_PER_CONDOMINI, NUMERO_MESI_PER_PRIVATI) MONTH)
     AND (CHIAVE_CLIENTE = -1 OR fatture_insolute_pregresse.ID_CLIENTE = CHIAVE_CLIENTE)
     AND fatture_insolute_pregresse.DATA_PAGAMENTO IS NULL
     AND fatture_insolute_pregresse.ID_MOVIMENTO IS NULL
     AND clienti.CHIAVE IN (SELECT contratti.ID_CLIENTE
                              FROM contratti
                             WHERE contratti.NON_CONFERMATO = 'F'
                               AND contratti.DISDETTATO = 'F'
                               AND contratti.SOSPENSIONE_TEMPORANEA = 'F'
                               AND contratti.TIPOLOGIA = 'M')
   ORDER BY CHIAVE, RAGIONE_SOCIALE ASC;
END
##END_BODY
##PARAMETRI
CHIAVE_CLIENTE	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
CONTROLLO_PRESENZA_QNT_PRODOTTI	PROCEDURE	__NULL__	
##BODY
BEGIN
  DECLARE PresenzaRecord INT;
  
  SELECT COUNT(*) 
    FROM qnt_x_magazzino
   WHERE qnt_x_magazzino.ID_PRODOTTO = CHIAVE_PRODOTTO
     AND qnt_x_magazzino.ID_MAGAZZINO = CHIAVE_MAGAZZINO
    INTO PresenzaRecord;
            
  IF PresenzaRecord = 0 THEN
     INSERT INTO qnt_x_magazzino (CHIAVE, ID_PRODOTTO, ID_MAGAZZINO, SOGLIA_ALLARME, QUANTITA_MAGAZZINO)
                          VALUES (GET_NEW_KEY(), CHIAVE_PRODOTTO, CHIAVE_MAGAZZINO, 0, 0);
  END IF; 
END
##END_BODY
##PARAMETRI
CHIAVE_PRODOTTO	IN	int
CHIAVE_MAGAZZINO	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
CORREGGI_QUANTITA_MAGAZZINO	PROCEDURE	__NULL__	
##BODY
BEGIN
   DECLARE v_MagazzinoRicevente INT;
   DECLARE v_MagazzinoCedente INT;
   DECLARE descr_MagazzinoRicevente TEXT;
   DECLARE descr_MagazzinoCedente TEXT;

   SELECT ID_MAGAZZINO_RICEVENTE INTO v_MagazzinoRicevente
     FROM movimenti_magazzini
    WHERE CHIAVE = ID_MOVIMENTO_MAGAZZINO;

   SELECT ID_MAGAZZINO_CEDENTE INTO v_MagazzinoCedente
     FROM movimenti_magazzini
    WHERE CHIAVE = ID_MOVIMENTO_MAGAZZINO;

   SELECT DESCRIZIONE INTO descr_MagazzinoRicevente
     FROM magazzini
    WHERE CHIAVE = v_MagazzinoRicevente;

   SELECT DESCRIZIONE INTO descr_MagazzinoCedente
     FROM magazzini
    WHERE CHIAVE = v_MagazzinoCedente;

   IF NOT IS_DELETE THEN
             
	   UPDATE qnt_x_magazzino
	      SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO + QUANTITA_PRODOTTO
	   WHERE ID_PRODOTTO = CHIAVE_PRODOTTO
	     AND ID_MAGAZZINO = v_MagazzinoRicevente;
	     
	    IF ROW_COUNT() = 0 THEN
	                            INSERT INTO qnt_x_magazzino (CHIAVE, ID_PRODOTTO, ID_MAGAZZINO, QUANTITA_MAGAZZINO, SOGLIA_ALLARME)
									    VALUES (GET_NEW_KEY(), CHIAVE_PRODOTTO, v_MagazzinoRicevente, QUANTITA_PRODOTTO, 0);
									END IF;
	
	   UPDATE qnt_x_magazzino
	      SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO - QUANTITA_PRODOTTO
	    WHERE ID_PRODOTTO = CHIAVE_PRODOTTO
	      AND ID_MAGAZZINO = v_MagazzinoCedente;
	      
	   IF IS_UPDATE THEN
	      
			INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, QUANTITA, DESCRIZIONE)
			VALUES (GET_NEW_KEY(), NOW(), CHIAVE_PRODOTTO, QUANTITA_PRODOTTO * (+1), CONCAT('Modificato movimento dal magazzino ', 
																												  descr_MagazzinoCedente, 
																												  ' al magazzino ',
																												  descr_MagazzinoRicevente
																												 ));
		
		ELSE
	      
			INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, QUANTITA, DESCRIZIONE)
			VALUES (GET_NEW_KEY(), NOW(), CHIAVE_PRODOTTO, QUANTITA_PRODOTTO * (+1), CONCAT('Aggiunto movimento dal magazzino ', 
																												  descr_MagazzinoCedente, 
																												  ' al magazzino ',
																												  descr_MagazzinoRicevente
																												));
																												
	   END IF;

	ELSE 
	   UPDATE qnt_x_magazzino
	      SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO - QUANTITA_PRODOTTO
	   WHERE ID_PRODOTTO = CHIAVE_PRODOTTO
	     AND ID_MAGAZZINO = v_MagazzinoRicevente;
	
	   UPDATE qnt_x_magazzino
	      SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO + QUANTITA_PRODOTTO
	    WHERE ID_PRODOTTO = CHIAVE_PRODOTTO
	      AND ID_MAGAZZINO = v_MagazzinoCedente;
	      
		INSERT INTO log_magazzino (CHIAVE, DATA, ID_PRODOTTO, QUANTITA, DESCRIZIONE)
		VALUES (GET_NEW_KEY(), NOW(), CHIAVE_PRODOTTO, QUANTITA_PRODOTTO * (-1), CONCAT('Eliminato movimento dal magazzino ', 
																												  descr_MagazzinoCedente, 
																												  ' al magazzino ',
																												  descr_MagazzinoRicevente
																												));
	 
	END IF;
	
END
##END_BODY
##PARAMETRI
CHIAVE_PRODOTTO	IN	int
QUANTITA_PRODOTTO	IN	int
ID_MOVIMENTO_MAGAZZINO	IN	int
IS_DELETE	IN	int
IS_UPDATE	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
DELETE_GENERAZIONE	PROCEDURE	__NULL__	
##BODY
BEGIN  
  UPDATE attrezzature SET attrezzature.ID_RAPPORTO_INTERVENTO_ULTIMA_ANOMALIA = NULL WHERE attrezzature.ID_RAPPORTO_INTERVENTO_ULTIMA_ANOMALIA IN  (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM incassi_confermati WHERE incassi_confermati.ID_FATTURA IN (SELECT CHIAVE FROM fatture WHERE fatture.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM fatture_da_mobile WHERE fatture_da_mobile.ID_FATTURA IN (SELECT CHIAVE FROM fatture WHERE fatture.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM rapporti_intervento_forniture WHERE rapporti_intervento_forniture.ID_RAPPORTO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM allegati_rapporti_intervento WHERE allegati_rapporti_intervento.ID_RAPPORTO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM xml_fatture WHERE xml_fatture.ID_FATTURA IN (SELECT CHIAVE FROM fatture WHERE fatture.MESE_GENERAZIONE = MESE_GENERAZIONE);

  DELETE FROM voci_fatture WHERE voci_fatture.ID_FATTURA IN (SELECT CHIAVE FROM fatture WHERE fatture.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM rate_fattura WHERE rate_fattura.ID_FATTURA IN (SELECT CHIAVE FROM fatture WHERE fatture.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM log_generazione_fatture WHERE log_generazione_fatture.ID_FATTURA IN (SELECT CHIAVE FROM fatture WHERE fatture.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM log_fatture WHERE log_fatture.ID_FATTURA IN (SELECT CHIAVE FROM fatture WHERE fatture.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM fatture WHERE fatture.MESE_GENERAZIONE = MESE_GENERAZIONE;
  DELETE FROM interventi_attrezzature WHERE interventi_attrezzature.ID_RAPPORTO_STATINO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM interventi_estintori WHERE interventi_estintori.ID_RAPPORTO_STATINO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM firme_rapporti WHERE firme_rapporti.ID_RAPPORTO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM fatture_da_mobile WHERE fatture_da_mobile.ID_RAPPORTO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM incassi_confermati WHERE incassi_confermati.ID_RAPPORTO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  UPDATE preventivi SET preventivi.ID_RAPPORTO = NULL WHERE preventivi.ID_RAPPORTO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM scadenzario WHERE scadenzario.ID_RAPPORTO IN (SELECT CHIAVE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE);
  DELETE FROM rapporti_intervento WHERE rapporti_intervento.MESE_GENERAZIONE = MESE_GENERAZIONE;
END
##END_BODY
##PARAMETRI
MESE_GENERAZIONE	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
EXIST_AVVISO_FATTURA_RAPPORTO	FUNCTION	int	
##BODY
BEGIN

DECLARE Result INT;

SELECT (EXISTS(SELECT CHIAVE 
                 FROM fatture 
                WHERE fatture.NUMERO IS NULL
					   AND fatture.ID_CONTRATTO = ChiaveContratto
                  AND fatture.MESE_GENERAZIONE = MeseGenerazione
						AND fatture.ID_CLIENTE = ChiaveCliente
						AND (fatture.ID_FILIALE = ChiaveFiliale
						     OR fatture.ID_FILIALE IS NULL)) <> 0)     
INTO Result;

RETURN Result;
END
##END_BODY
##PARAMETRI
MeseGenerazione	IN	int
ChiaveCliente	IN	int
ChiaveContratto	IN	int
ChiaveFiliale	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
EXIST_FATTURA_GENERATA	FUNCTION	int	
##BODY
BEGIN

DECLARE Result INT;

SELECT (EXISTS(SELECT * 
               FROM fatture 
              WHERE fatture.ID_CONTRATTO = ChiaveContratto
                AND fatture.MESE_GENERAZIONE = Mese) <> 0)     
INTO Result;

RETURN Result;
END
##END_BODY
##PARAMETRI
ChiaveContratto	IN	int
Mese	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
EXIST_RAPPORTO_GENERATO	FUNCTION	int	
##BODY
BEGIN

DECLARE Result INT;

SELECT (EXISTS(SELECT * 
               FROM rapporti_intervento
              WHERE rapporti_intervento.ID_CONTRATTO     = ChiaveContratto
                AND rapporti_intervento.ID_FILIALE       = ChiaveFiliale
                AND rapporti_intervento.MESE_GENERAZIONE = Mese) <> 0)     
INTO Result;

RETURN Result;
END
##END_BODY
##PARAMETRI
ChiaveContratto	IN	int
ChiaveFiliale	IN	int
Mese	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
GET_IMPONIBILE	FUNCTION	float	
##BODY
BEGIN

  DECLARE CicloFinito INTEGER DEFAULT 0;
  DECLARE LocalImporto INT(11);
  DECLARE LocalImportoIvato VARCHAR(1);
  DECLARE LocalQuantita INT(11);
  DECLARE LocalSconto INT;
  DECLARE LocalIva INT;
  DECLARE Imponibile FLOAT DEFAULT 0;
  

  DECLARE CursoreImportoVoci 
    CURSOR FOR 
	SELECT IMPORTO, QUANTITA, IMPORTO_IVATO, QUANTITA, SCONTO, IVA
	  FROM voci_fatture
	 WHERE ID_FATTURA = CHIAVE_FATTURA;

  DECLARE CONTINUE HANDLER 
        FOR NOT FOUND SET CicloFinito = 1;

  SET Imponibile = 0;
  OPEN CursoreImportoVoci;
	
  GetImponibile: LOOP
    FETCH CursoreImportoVoci INTO LocalImporto,LocalQuantita, LocalImportoIvato, LocalQuantita, LocalSconto, LocalIva;
    IF CicloFinito = 1 THEN 
      LEAVE GetImponibile;
    END IF;
    
    IF LocalImportoIvato = 'T' THEN
	   SET LocalImporto = (LocalImporto * 100 / (LocalIva + 100));
      SET Imponibile = Imponibile + ((LocalQuantita * LocalImporto) - (LocalImporto * LocalSconto / 100));
	 ELSE
	   SET Imponibile = Imponibile + (LocalQuantita * LocalImporto) - (LocalImporto * LocalSconto / 100);
     END IF;

  END LOOP GetImponibile;
  
  CLOSE CursoreImportoVoci;
  
  RETURN Imponibile;

END
##END_BODY
##PARAMETRI
CHIAVE_FATTURA	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
GET_IMPONIBILE_AUTOFATTURE	FUNCTION	float	
##BODY
BEGIN

  DECLARE CicloFinito INTEGER DEFAULT 0;
  DECLARE LocalImporto INT(11);
  DECLARE LocalImportoIvato VARCHAR(1);
  DECLARE LocalQuantita INT(11);
  DECLARE LocalSconto INT;
  DECLARE LocalIva INT;
  DECLARE Imponibile FLOAT DEFAULT 0;
  

  DECLARE CursoreImportoVoci 
    CURSOR FOR 
	SELECT IMPORTO, QUANTITA, IMPORTO_IVATO, QUANTITA, SCONTO, IVA
	  FROM voci_autofatture
	 WHERE ID_AUTOFATTURA = CHIAVE_AUTOFATTURA;

  DECLARE CONTINUE HANDLER 
        FOR NOT FOUND SET CicloFinito = 1;

  SET Imponibile = 0;
  OPEN CursoreImportoVoci;
	
  GetImponibile: LOOP
    FETCH CursoreImportoVoci INTO LocalImporto,LocalQuantita, LocalImportoIvato, LocalQuantita, LocalSconto, LocalIva;
    IF CicloFinito = 1 THEN 
      LEAVE GetImponibile;
    END IF;
    
    IF LocalImportoIvato = 'T' THEN
	   SET LocalImporto = (LocalImporto * 100 / (LocalIva + 100));
      SET Imponibile = Imponibile + ((LocalQuantita * LocalImporto) - (LocalImporto * LocalSconto / 100));
	 ELSE
	   SET Imponibile = Imponibile + (LocalQuantita * LocalImporto) - (LocalImporto * LocalSconto / 100);
     END IF;

  END LOOP GetImponibile;
  
  CLOSE CursoreImportoVoci;
  
  RETURN Imponibile;

END
##END_BODY
##PARAMETRI
CHIAVE_AUTOFATTURA	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
GET_IMPONIBILE_NOTE	FUNCTION	float	
##BODY
BEGIN

  DECLARE CicloFinito INTEGER DEFAULT 0;
  DECLARE LocalImporto INT(11);
  DECLARE LocalImportoIvato VARCHAR(1);
  DECLARE LocalQuantita INT(11);
  DECLARE LocalSconto INT;
  DECLARE LocalIva INT;
  DECLARE Imponibile FLOAT DEFAULT 0;
  

  DECLARE CursoreImportoVoci 
    CURSOR FOR 
	SELECT IMPORTO, QUANTITA, IMPORTO_IVATO, QUANTITA, SCONTO, IVA
	  FROM voci_note_di_credito
	 WHERE ID_NOTA_DI_CREDITO = CHIAVE_NOTA;

  DECLARE CONTINUE HANDLER 
        FOR NOT FOUND SET CicloFinito = 1;

  SET Imponibile = 0;
  OPEN CursoreImportoVoci;
	
  GetImponibile: LOOP
    FETCH CursoreImportoVoci INTO LocalImporto,LocalQuantita, LocalImportoIvato, LocalQuantita, LocalSconto, LocalIva;
    IF CicloFinito = 1 THEN 
      LEAVE GetImponibile;
    END IF;
    
    IF LocalImportoIvato = 'T' THEN
	   SET LocalImporto = (LocalImporto * 100 / (LocalIva + 100));
      SET Imponibile = Imponibile + ((LocalQuantita * LocalImporto) - (LocalImporto * LocalSconto / 100));
	 ELSE
	   SET Imponibile = Imponibile + (LocalQuantita * LocalImporto) - (LocalImporto * LocalSconto / 100);
     END IF;

  END LOOP GetImponibile;
  
  CLOSE CursoreImportoVoci;
  
  RETURN Imponibile;

END
##END_BODY
##PARAMETRI
CHIAVE_NOTA	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
GET_NEW_KEY	FUNCTION	int	
##BODY
BEGIN
 DECLARE Result INT DEFAULT 0;

 UPDATE gen_key
   SET CHIAVE = CHIAVE + 1;

SELECT MAX(CHIAVE) FROM gen_key INTO Result;
 RETURN Result;  

END
##END_BODY
##PARAMETRI
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
INCREMENTA_MAGAZZINO	PROCEDURE	__NULL__	
##BODY
BEGIN
	DECLARE ProdottoComposto CHAR(1);
	DECLARE QuantitaProdottoSemplice INT;
	DECLARE IdProdottoSemplice INT;
	DECLARE FINITO INT DEFAULT FALSE;

    DECLARE CursorProdotti CURSOR FOR 
        SELECT prodotti_x_montaggio.QUANTITA,
               prodotti_x_montaggio.PRODOTTO_SEMPLICE
		                      FROM prodotti_x_montaggio
									WHERE prodotti_x_montaggio.ID_MONTAGGIO = CHIAVE_PRODOTTO;

	DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINITO = TRUE;
	
	SELECT prodotti.PRODOTTO_COMPOSTO
      INTO ProdottoComposto
	  FROM prodotti
     WHERE prodotti.CHIAVE = CHIAVE_PRODOTTO;
	
	IF ProdottoComposto = 'T' THEN
		OPEN CursorProdotti;
		LoopCursor: LOOP
			FETCH CursorProdotti INTO QuantitaProdottoSemplice, IdProdottoSemplice;
			IF FINITO THEN
				LEAVE LoopCursor;
			END IF; 
				CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(IdProdottoSemplice, CHIAVE_MAGAZZINO);
				
            UPDATE qnt_x_magazzino
				SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO + (QuantitaProdottoSemplice * QUANTITA_PRODOTTO)
             WHERE ID_PRODOTTO = IdProdottoSemplice
               AND ID_MAGAZZINO = CHIAVE_MAGAZZINO;
        END LOOP LoopCursor;
    	CLOSE CursorProdotti;
   
   ELSE
   	  CALL CONTROLLO_PRESENZA_QNT_PRODOTTI(CHIAVE_PRODOTTO, CHIAVE_MAGAZZINO);
   	  
        UPDATE qnt_x_magazzino
			SET QUANTITA_MAGAZZINO = QUANTITA_MAGAZZINO + QUANTITA_PRODOTTO
         WHERE ID_PRODOTTO = CHIAVE_PRODOTTO
           AND ID_MAGAZZINO = CHIAVE_MAGAZZINO;
	END IF;
END
##END_BODY
##PARAMETRI
CHIAVE_PRODOTTO	IN	int
CHIAVE_MAGAZZINO	IN	int
QUANTITA_PRODOTTO	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
NEW_NUMERO_AUTOFATTURA	FUNCTION	int	
##BODY
BEGIN
  DECLARE Result INT;
  
  SELECT MAX(NUMERO)
    FROM autofatture
   WHERE ANNO = ANNO_AUTOFATTURA
    INTO Result;
    
  IF Result IS NULL THEN
     SET Result = 1;
  ELSE 
     SET Result = Result + 1; 
  END IF;
  
  RETURN Result; 
	   
END
##END_BODY
##PARAMETRI
ANNO_AUTOFATTURA	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
NEW_NUMERO_DDT	FUNCTION	int	
##BODY
BEGIN
  DECLARE ConteggioDDT INT;
  DECLARE NuovoNumero INT;
  DECLARE AnnoPrimoDDT INT;
  DECLARE NumeroPrimoDDT INT;
    
 SELECT COUNT(*)
   FROM ddt_uscenti
  WHERE EXTRACT(YEAR FROM DATA_DDT) = ANNO_DEL_DDT
    AND NUMERO_DDT IS NOT NULL
   INTO ConteggioDDT;

 IF ConteggioDDT = 0 THEN
	   SELECT ANNO_PRIMO_DDT
	     FROM impostazioni
	     INTO AnnoPrimoDDT;
	   SELECT NUMERO_PRIMO_DDT
	     FROM impostazioni
	     INTO NumeroPrimoDDT;
	     
	   IF(AnnoPrimoDDT = ANNO_DEL_DDT) THEN
	     SET NuovoNumero = NumeroPrimoDDT;
	   ELSE
	     SET NuovoNumero = 1;
	   END IF;  
 ELSE   
	  SELECT MAX(NUMERO_DDT)
	    FROM ddt_uscenti
	   WHERE ANNO_DDT = ANNO_DEL_DDT
	    INTO NuovoNumero;
    
	  IF NuovoNumero IS NULL THEN
	     SET NuovoNumero = 1;
	  ELSE 
	     SET NuovoNumero = NuovoNumero + 1; 
	  END IF;
 END IF;
  
 RETURN NuovoNumero; 
	   
END
##END_BODY
##PARAMETRI
ANNO_DEL_DDT	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
NEW_NUMERO_DDT_ENTRANTI	FUNCTION	int	
##BODY
BEGIN
  DECLARE ConteggioDDT INT;
  DECLARE NuovoNumero INT;
  DECLARE AnnoPrimoDDT INT;
  DECLARE NumeroPrimoDDT INT;
    
 SELECT COUNT(*)
   FROM ddt_entranti
  WHERE EXTRACT(YEAR FROM DATA_DDT) = ANNO_DEL_DDT
    AND NUMERO_DDT IS NOT NULL
   INTO ConteggioDDT;

 IF ConteggioDDT = 0 THEN
	   SELECT ANNO_PRIMO_DDT
	     FROM impostazioni
	     INTO AnnoPrimoDDT;
	   SELECT NUMERO_PRIMO_DDT
	     FROM impostazioni
	     INTO NumeroPrimoDDT;
	     
	   IF(AnnoPrimoDDT = ANNO_DEL_DDT) THEN
	     SET NuovoNumero = NumeroPrimoDDT;
	   ELSE
	     SET NuovoNumero = 1;
	   END IF;  
 ELSE   
	  SELECT MAX(NUMERO_DDT)
	    FROM ddt_entranti
	   WHERE ANNO_DDT = ANNO_DEL_DDT
	    INTO NuovoNumero;
    
	  IF NuovoNumero IS NULL THEN
	     SET NuovoNumero = 1;
	  ELSE 
	     SET NuovoNumero = NuovoNumero + 1; 
	  END IF;
 END IF;
  
 RETURN NuovoNumero; 
	   
END
##END_BODY
##PARAMETRI
ANNO_DEL_DDT	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
NEW_NUMERO_DOC	FUNCTION	int	
##BODY
BEGIN
  DECLARE ConteggioDoc INT;
  DECLARE NuovoNumero INT;
  DECLARE AnnoPrimoDoc INT;
  DECLARE NumeroPrimoDoc INT;
    
 SELECT COUNT(*)
   FROM doc_scarico_prodotti_composti
  WHERE EXTRACT(YEAR FROM DATA_DOCUMENTO) = ANNO_DEL_DOCUMENTO
    AND NUMERO_DOCUMENTO IS NOT NULL
   INTO ConteggioDoc;

 IF ConteggioDoc = 0 THEN
	   SELECT ANNO_PRIMO_DOC
	     FROM impostazioni
	     INTO AnnoPrimoDoc;
	   SELECT NUMERO_PRIMO_DOC
	     FROM impostazioni
	     INTO NumeroPrimoDoc;
	     
	   IF(AnnoPrimoDoc = ANNO_DEL_DOCUMENTO) THEN
	     SET NuovoNumero = NumeroPrimoDoc;
	   ELSE
	     SET NuovoNumero = 1;
	   END IF;  
 ELSE   
	  SELECT MAX(NUMERO_DOCUMENTO)
	    FROM doc_scarico_prodotti_composti
	   WHERE ANNO_DOCUMENTO = ANNO_DEL_DOCUMENTO
	    INTO NuovoNumero;
    
	  IF NuovoNumero IS NULL THEN
	     SET NuovoNumero = 1;
	  ELSE 
	     SET NuovoNumero = NuovoNumero + 1; 
	  END IF;
 END IF;
  
 RETURN NuovoNumero; 
	   
END
##END_BODY
##PARAMETRI
ANNO_DEL_DOCUMENTO	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
NEW_NUMERO_PREVENTIVO	FUNCTION	int	
##BODY
BEGIN
  DECLARE ConteggioPreventivi INT;
  DECLARE NuovoNumero INT;
  DECLARE AnnoPrimoPreventivo INT;
  DECLARE NumeroPrimoPreventivo INT;
  
 SELECT COUNT(*)
   FROM preventivi
  WHERE EXTRACT(YEAR FROM DATA) = ANNO_PREVENTIVO
    AND NUMERO IS NOT NULL
   INTO ConteggioPreventivi;
   
 IF ConteggioPreventivi = 0 THEN
	   SELECT ANNO_PRIMO_PREVENTIVO
	     FROM impostazioni
	     INTO AnnoPrimoPreventivo;
	   SELECT NUMERO_PRIMO_PREVENTIVO
	     FROM impostazioni
	     INTO NumeroPrimoPreventivo;
	     
	   IF(AnnoPrimoPreventivo = ANNO_PREVENTIVO) THEN
	     SET NuovoNumero = NumeroPrimoPreventivo;
	   ELSE
	     SET NuovoNumero = 1;
	   END IF;  
 ELSE
	  SELECT MAX(NUMERO)
	    FROM preventivi
	   WHERE ANNO = ANNO_PREVENTIVO
	    INTO NuovoNumero;
	    
	  IF NuovoNumero IS NULL THEN
	     SET NuovoNumero = 1;
	  ELSE 
	     SET NuovoNumero = NuovoNumero + 1; 
	  END IF;
	END IF;
  
  RETURN NuovoNumero; 
	   
END
##END_BODY
##PARAMETRI
ANNO_PREVENTIVO	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
NEW_NUMERO_PREVENTIVO_MULTI	FUNCTION	int	
##BODY
BEGIN
  DECLARE ConteggioPreventivi INT;
  DECLARE NuovoNumero INT;
  DECLARE AnnoPrimoPreventivo INT;
  DECLARE NumeroPrimoPreventivo INT;
  
 SELECT COUNT(*)
   FROM preventivi_multiparametrici
  WHERE EXTRACT(YEAR FROM DATA) = ANNO_PREVENTIVO
    AND NUMERO IS NOT NULL
    AND preventivi_multiparametrici.NUMERO_REVISIONE = 1
   INTO ConteggioPreventivi;
   
 IF ConteggioPreventivi = 0 THEN
	   SELECT ANNO_PRIMO_PREVENTIVO_MULTI
	     FROM impostazioni
	     INTO AnnoPrimoPreventivo;
	   SELECT NUMERO_PRIMO_PREVENTIVO_MULTI
	     FROM impostazioni
	     INTO NumeroPrimoPreventivo;
	     
	   IF(AnnoPrimoPreventivo = ANNO_PREVENTIVO) THEN
	     SET NuovoNumero = NumeroPrimoPreventivo;
	   ELSE
	     SET NuovoNumero = 1;
	   END IF;  
 ELSE
	  SELECT MAX(NUMERO)
	    FROM preventivi_multiparametrici
	   WHERE ANNO = ANNO_PREVENTIVO
        AND preventivi_multiparametrici.NUMERO_REVISIONE = 1
	    INTO NuovoNumero;
	    
	  IF NuovoNumero IS NULL THEN
	     SET NuovoNumero = 1;
	  ELSE 
	     SET NuovoNumero = NuovoNumero + 1; 
	  END IF;
	END IF;
  
  RETURN NuovoNumero; 
	   
END
##END_BODY
##PARAMETRI
ANNO_PREVENTIVO	IN	int
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
svuota_gemini	PROCEDURE	__NULL__	
##BODY
BEGIN
    DECLARE done INT DEFAULT 0;
    DECLARE tbl VARCHAR(255);

    DECLARE cur CURSOR FOR
        SELECT table_name
        FROM information_schema.tables
        WHERE table_schema = 'gemini'
          AND table_name <> 'utenti';

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

    SET FOREIGN_KEY_CHECKS = 0;

    OPEN cur;

    read_loop: LOOP
        FETCH cur INTO tbl;
        IF done = 1 THEN
            LEAVE read_loop;
        END IF;

        SET @sql = CONCAT('TRUNCATE TABLE `', tbl, '`');
        PREPARE stmt FROM @sql;
        EXECUTE stmt;
        DEALLOCATE PREPARE stmt;
    END LOOP;

    CLOSE cur;

    SET FOREIGN_KEY_CHECKS = 1;
END
##END_BODY
##PARAMETRI
##END_PARAMETRI
##END_LISTA_PROCEDURE

##LISTA_PROCEDURE
UPDATE_RITENUTA_CLIENTE	PROCEDURE	__NULL__	
##BODY
BEGIN
  DECLARE ConteggioRecord INT;
  
  SELECT COUNT(*) 
    FROM ritenute_cliente
   WHERE ID_CLIENTE = IdCliente
     AND ANNO = AnnoPagamento
     AND IDENTIFICATIVO_FISCALE = IdentificativoFiscale
    INTO ConteggioRecord;
   
  IF ConteggioRecord > 0 THEN
     UPDATE ritenute_cliente
	     SET RITENUTA = RitenutaPagata
	   WHERE ID_CLIENTE = IdCliente
		  AND ANNO = AnnoPagamento
		  AND IDENTIFICATIVO_FISCALE = IdentificativoFiscale;
  ELSE 
    INSERT INTO ritenute_cliente (ID_CLIENTE,ANNO,RITENUTA,IDENTIFICATIVO_FISCALE) VALUES (IdCliente,AnnoPagamento,RitenutaPagata,IdentificativoFiscale);
  END IF; 
END
##END_BODY
##PARAMETRI
IdCliente	IN	int
RitenutaPagata	IN	int
AnnoPagamento	IN	int
IdentificativoFiscale	IN	varchar(255)
##END_PARAMETRI
##END_LISTA_PROCEDURE

